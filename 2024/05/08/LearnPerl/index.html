<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"wangxianke123.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Per 语言的学习记录，主要记录一些Per语言的学习笔记。教材用的是骆驼书第6版。">
<meta property="og:type" content="article">
<meta property="og:title" content="LearnPerl">
<meta property="og:url" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/index.html">
<meta property="og:site_name" content="花间一壶酒">
<meta property="og:description" content="Per 语言的学习记录，主要记录一些Per语言的学习笔记。教材用的是骆驼书第6版。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image2.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image1.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-1.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-2.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-3.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-5.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-7.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-9.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-10.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-11.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-13.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-14.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-15.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-16.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-17.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-19.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-18.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-20.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-21.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-22.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-24.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-25.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-26.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-27.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-28.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-29.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-30.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-31.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-32.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-33.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-34.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-35.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-36.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-37.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-38.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-39.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-40.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-41.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-42.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-43.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-44.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-45.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-46.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-47.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-48.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-49.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-51.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-53.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-54.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-55.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-56.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-57.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-58.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-59.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-60.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-61.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-62.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-63.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-64.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-65.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-67.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-66.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-68.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-69.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-70.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-71.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-72.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-73.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-74.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-75.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-76.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-77.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-78.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-79.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-80.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-81.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-82.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-83.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-84.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-85.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-86.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-87.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-88.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-89.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-90.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-91.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-92.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-93.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-94.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-95.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-96.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-97.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-98.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-99.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-100.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-101.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-102.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-103.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-104.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-105.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-106.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-109.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-110.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-111.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-112.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-113.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-114.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-115.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-116.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-117.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-118.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-119.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-120.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-121.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-122.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-123.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-124.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-125.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-126.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-127.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-128.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-129.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-130.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-131.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-132.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-134.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-133.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-135.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-136.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-137.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-138.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-140.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-141.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-142.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-143.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-144.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-145.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-146.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-147.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-148.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-149.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-150.png">
<meta property="og:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image-151.png">
<meta property="article:published_time" content="2024-05-08T05:56:47.000Z">
<meta property="article:modified_time" content="2024-08-23T02:40:25.537Z">
<meta property="article:author" content="Wang xianke">
<meta property="article:tag" content="Programming Language">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wangxianke123.github.io/2024/05/08/LearnPerl/image.png">

<link rel="canonical" href="https://wangxianke123.github.io/2024/05/08/LearnPerl/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>LearnPerl | 花间一壶酒</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>


  <script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>
    
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">花间一壶酒</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">举杯邀明月，对影成三人</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wangxianke123.github.io/2024/05/08/LearnPerl/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Wang xianke">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="花间一壶酒">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          LearnPerl
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-05-08 13:56:47" itemprop="dateCreated datePublished" datetime="2024-05-08T13:56:47+08:00">2024-05-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-08-23 10:40:25" itemprop="dateModified" datetime="2024-08-23T10:40:25+08:00">2024-08-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/notes/" itemprop="url" rel="index"><span itemprop="name">notes</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>58k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1:45</span>
            </span>
            <div class="post-description">Per 语言的学习记录，主要记录一些Per语言的学习笔记。教材用的是骆驼书第6版。</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="Learn-Perl"><a href="#Learn-Perl" class="headerlink" title="Learn Perl"></a>Learn Perl</h1><h2 id="Ch2-标量数据"><a href="#Ch2-标量数据" class="headerlink" title="Ch2 标量数据"></a>Ch2 标量数据</h2><h3 id="第一个Helloword-程序"><a href="#第一个Helloword-程序" class="headerlink" title="第一个Helloword 程序"></a>第一个Helloword 程序</h3><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;Hello, world!\n&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>perl是一种脚本语言，一般已经被内置在类unix系统中。类似的还有shell，bash,csh,tcl,python等。</p>
<p>第一行的<code>#!</code>读作shell bang。shell bang 是一个用于指定脚本解释器的特殊字符组合。它由 <code>#</code>（井号）和 <code>!</code>（感叹号）组合而成，通常位于脚本的第一行。当一个脚本被执行时，系统会参考 shebang 指定的解释器来执行这个脚本。</p>
<p>例如，如果一个脚本的第一行是 <code>#!/bin/bash</code>，那么这个脚本就会使用 Bash 作为其解释器。如果改为 <code>#!/usr/bin/python3</code>，那么这个脚本就会使用 Python 3 作为其解释器。</p>
<p>linux默认的脚本解释器总是在&#x2F;usr&#x2F;bin目录下，如果解释器安装在其他目录下，则需要修改对应的路径。</p>
<p>由于有shell bang的存在，perl程序不需要有特定的扩展名，而只需要是<strong>可执行</strong>的。（为了区分可以加上<code>.pl</code>）的后缀。</p>
<p>此外也可以直接通过<code>perl</code>命令执行脚本。这2种方式大部分情况下是相同的，然而有时候也会产生不同的效果。</p>
<p><img src="/2024/05/08/LearnPerl/image.png"><br>目前本人还没搞清楚这种情况出现的原因。</p>
<p>反引号&#96;&#96;可以用于执行外部命令:</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"> @lines = <span class="string">`ls -a`</span>;</span><br><span class="line"> <span class="keyword">foreach</span> (@lines) &#123;</span><br><span class="line">  <span class="keyword">print</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="标量数据"><a href="#标量数据" class="headerlink" title="标量数据"></a>标量数据</h3><p>字符串，数字都被看做标量数据。</p>
<p>perl会根据数据的操作符判断执行代数运算还是字符串操作。</p>
<p>变量采用美元符号声明：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">$alef  = <span class="keyword">chr</span>( <span class="number">0x05D0</span> );</span><br><span class="line">$alpha = <span class="keyword">chr</span>( <span class="keyword">hex</span>(<span class="string">&#x27;03B1&#x27;</span>) );</span><br><span class="line">$omega = <span class="keyword">chr</span>( <span class="number">0x03C9</span> );</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;alpha:&quot;</span>.$alpha;</span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;alef:&quot;</span>.$alef;</span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;omega:&quot;</span>.$omega;</span><br><span class="line"></span><br><span class="line">$code_point = <span class="keyword">ord</span>( <span class="string">&#x27;א&#x27;</span> );</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> $code_point;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image2.png"><br>chr函数会将对应的ascii字符进行转换。ord则相反。</p>
<p>使用<code>x</code>可以将字符串重复对应的次数。</p>
<p><img src="/2024/05/08/LearnPerl/image1.png"></p>
<p><code>say</code>和<code>print</code>类似，区别是会自动换行。（需要5.10以上的版本）</p>
<p>使用<code>.</code>可以连接2个字符串。</p>
<h3 id="其他特性"><a href="#其他特性" class="headerlink" title="其他特性"></a>其他特性</h3><p>获取标准输入：<code>&lt;STDIN&gt;</code></p>
<p><img src="/2024/05/08/LearnPerl/image-1.png"></p>
<p><img src="/2024/05/08/LearnPerl/image-2.png"></p>
<p><code>chomp</code>的作用是去掉字符串末尾的换行符。</p>
<h2 id="Ch3-列表和数组"><a href="#Ch3-列表和数组" class="headerlink" title="Ch3 列表和数组"></a>Ch3 列表和数组</h2><p>列表(list)和数组(array)都用于表示多个变量。二者的区别在于，“列表”是数据的集合，而“数组”是存储列表的变量。即列表更倾向于数据，数组更倾向于变量。列表不一定放在数组里，而数组中一定保护列表。</p>
<h3 id="数组array"><a href="#数组array" class="headerlink" title="数组array"></a>数组array</h3><p>数组和标量的声明方式完全相同。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line">$word[<span class="number">0</span>]= <span class="string">&quot;s&quot;</span>;</span><br><span class="line">$word[<span class="number">1</span>]= <span class="string">&quot;j&quot;</span>;</span><br><span class="line">$word[<span class="number">2</span>]= <span class="string">&quot;t&quot;</span>;</span><br><span class="line">$word[<span class="number">3</span>]= <span class="string">&quot;uuu&quot;</span>;</span><br><span class="line"></span><br><span class="line">$word[<span class="number">18</span>]=<span class="string">&quot;end&quot;</span>;</span><br><span class="line">$end = $#word;</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> $end;</span><br><span class="line"><span class="keyword">say</span> $word;</span><br><span class="line"><span class="keyword">say</span>  $word[-<span class="number">19</span>].$word[-<span class="number">18</span>].$word[-<span class="number">17</span>].$word[-<span class="number">16</span>];</span><br><span class="line"><span class="keyword">say</span> @word</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image-3.png"></p>
<p>‘#’井号代表取数组的最后一个下标值，除了正着数，数组下标也可以用来倒数，如第三行所示。</p>
<p>第二行的输出为空，是因为$word被看作是一个标量，与数组不同，由于没有对这个标量赋值，所以输出为空。如果向输出列表的完整值，则应该使用@符号：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">say</span> @word;</span><br></pre></td></tr></table></figure>
<p>使用超过原本数组长度的数组进行赋值会自动扩充数组，中间的元素被的值为undef</p>
<h3 id="array"><a href="#array" class="headerlink" title="array"></a>array</h3><h4 id="push-pop-shift-unshift"><a href="#push-pop-shift-unshift" class="headerlink" title="push,pop,shift,unshift"></a>push,pop,shift,unshift</h4><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">@a=(<span class="number">1.7</span>..<span class="number">5.7</span>);</span><br><span class="line"><span class="keyword">say</span> @a;</span><br><span class="line">($a,$b,$c) = <span class="string">qw(apple pear banana)</span>;</span><br><span class="line"><span class="keyword">say</span> $a.$b.$c;</span><br><span class="line"></span><br><span class="line"><span class="comment"># qw means quoted word</span></span><br><span class="line">@mylist = <span class="keyword">qw</span>/</span><br><span class="line">s</span><br><span class="line">j</span><br><span class="line">t</span><br><span class="line">u  a b c</span><br><span class="line">/;</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> <span class="keyword">pop</span> @mylist;</span><br><span class="line"><span class="keyword">say</span> @mylist;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@list = <span class="number">1</span>..<span class="number">7</span>;</span><br><span class="line"><span class="keyword">push</span> @list, <span class="number">3</span>;</span><br><span class="line"><span class="keyword">say</span> $list[-<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> <span class="keyword">shift</span> @list;</span><br><span class="line"><span class="keyword">say</span> @list;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unshift</span> @list,<span class="number">0</span>;</span><br><span class="line"><span class="keyword">say</span> @list[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">say</span> @list</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-5.png"></p>
<p>第一种的<code>..</code>表示递增，但是只能以整数方式进行。</p>
<p>第二行的示例显示了一种将列表的值赋值给变量的方法。</p>
<p>qw的意思为”quoted words”可以用来省略字符串中的引号。使用qw后，空格或换号符都可以之间作为字符串的分隔。</p>
<p>push和pop类似于其他语法中的列表操作。需要注意的是对列表用$还是@效果都是一样的。</p>
<p>shift和unshift对列表头进行操作，相当于pop_front和push_front。</p>
<h4 id="splice"><a href="#splice" class="headerlink" title="splice"></a>splice</h4><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line">@school = <span class="keyword">qw</span>/</span><br><span class="line">S</span><br><span class="line">J</span><br><span class="line">T</span><br><span class="line">U</span><br><span class="line">G</span><br><span class="line">G/;</span><br><span class="line"></span><br><span class="line">@remove = <span class="keyword">splice</span> @school,<span class="number">0</span>,<span class="number">4</span>;</span><br><span class="line"><span class="keyword">say</span> @remove;</span><br><span class="line"><span class="keyword">say</span> @school;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@remove = <span class="keyword">splice</span> @school, <span class="number">0</span>,<span class="number">0</span>,<span class="keyword">qw</span>/D D/;</span><br><span class="line"><span class="keyword">say</span> @remove;</span><br><span class="line"><span class="keyword">say</span> @school;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-7.png"></p>
<p>splice最多可以接收4个参数，后面2个可以省略。其中第一个参数表示要操作的列表，第二个参数表示分割的起始索引位置，第三个参数表示分割的长度，第四个参数表示分割后插入的元素。插入的位置在被分割的起始位置。</p>
<p>如果第3个参数设置为0，则splice可以被当作插入函数在第二个参数指定的位置进行插入。</p>
<h4 id="字符串数组内插"><a href="#字符串数组内插" class="headerlink" title="字符串数组内插"></a>字符串数组内插</h4><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">@seasons= <span class="keyword">qw</span>\spring summer autumn <span class="keyword">and</span> winter.\;</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;I miss you in @seasons&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;This is a reall hot $seasons[1]&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-9.png"></p>
<p>使用对应的索引或者完整的数组引用可以对字符串实现内插操作。如果希望使用原本的@符号或者[],则需要在前面加上反斜杠\进行转义。</p>
<h4 id="foreach"><a href="#foreach" class="headerlink" title="foreach"></a>foreach</h4><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$letter = <span class="string">&#x27;s&#x27;</span>;</span><br><span class="line"></span><br><span class="line">@alph =<span class="string">qw(b d p l m n z)</span>;</span><br><span class="line"><span class="keyword">foreach</span> $letter (@alph) &#123;</span><br><span class="line">    $letter .=<span class="string">&quot;a\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;alph is now:&quot;</span>,@alph;</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;letter is still: $letter\n&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>foreach语句用于遍历列表元素，并且对应用来遍历的临时变量，不用担心其与已有的标量重名。</p>
<h4 id="默认变量"><a href="#默认变量" class="headerlink" title="默认变量 $_"></a>默认变量 $_</h4><p>对于不指定变量的操作，统一使用默认变量$_:</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="number">1</span>..<span class="number">10</span>)&#123;</span><br><span class="line">    <span class="keyword">say</span> <span class="string">&quot;I can count to $_!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$_ = <span class="string">&quot;makabaka&quot;</span>;</span><br><span class="line"><span class="keyword">say</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image-10.png"></p>
<h4 id="reverse-sort-each"><a href="#reverse-sort-each" class="headerlink" title="reverse,sort,each"></a>reverse,sort,each</h4><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">@a=<span class="number">1</span>..<span class="number">10</span>;</span><br><span class="line">@b = <span class="keyword">reverse</span> @a;</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> @a;</span><br><span class="line"><span class="keyword">say</span> @b;</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> <span class="keyword">sort</span> @b;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> @rocks =<span class="keyword">qw</span>/bedrock slate rubble granite /;</span><br><span class="line"><span class="keyword">while</span>(<span class="keyword">my</span> ($index,$value)=<span class="keyword">each</span> @rocks )&#123;</span><br><span class="line">    <span class="keyword">say</span> <span class="string">&quot;$index:$value&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-11.png"></p>
<p>reverse用于将列表反转。<br>sort用于排序。排序规则是根据首字母的assicii值，并以此类推(首字母相同则比较下一个字母).</p>
<p>each可以创建索引和元素的键值对。</p>
<p><code>my</code> 关键字用于声明局部变量，使得这些变量的作用域仅限于其声明的代码块内。在你的代码中，<code>my</code> 用来声明 <code>$index</code> 和 <code>$value</code>，以便在 <code>while</code> 循环的每次迭代中使用它们来存储当前的索引和值。</p>
<h4 id="列表上下文与标量上下文"><a href="#列表上下文与标量上下文" class="headerlink" title="列表上下文与标量上下文"></a>列表上下文与标量上下文</h4><p>对于列表变量，由于其有多个属性，如里面的元素，元素的个数等，因此perl设计在引用列表变量时，不同的上下文环境中，列表变量的返回值不同。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@people = <span class="keyword">qw</span>/ fred barney betty /;</span><br><span class="line"></span><br><span class="line">@sorted = <span class="keyword">sort</span> @people;</span><br><span class="line">$number = <span class="number">42</span>+@people;</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> $number;</span><br><span class="line"><span class="keyword">say</span> @sorted;</span><br><span class="line"></span><br><span class="line">$backward=<span class="keyword">reverse</span> @people;</span><br><span class="line"><span class="keyword">say</span> $backward;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-13.png"></p>
<p>@people第一次调用时为列表上下文，返回列表中的所有元素进行排序。第二次由于与一个标量做加法，返回了列表的元素个数3。第三次调用reverse后复制给一个标量，因此返回了列表中所有元素合并而成的字符串。</p>
<p><img src="/2024/05/08/LearnPerl/image-14.png"></p>
<h4 id="列表上下文中使用标量表达式-强制标量上下文"><a href="#列表上下文中使用标量表达式-强制标量上下文" class="headerlink" title="列表上下文中使用标量表达式&amp;强制标量上下文"></a>列表上下文中使用标量表达式&amp;强制标量上下文</h4><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">@fred = <span class="number">6</span>*<span class="number">7</span>;</span><br><span class="line">@barney = <span class="string">&quot;hello&quot;</span>.<span class="string">&quot; &quot;</span>.<span class="string">&quot;world&quot;</span>;</span><br><span class="line"><span class="keyword">say</span> @fred;</span><br><span class="line"><span class="keyword">say</span> @barney;</span><br><span class="line"></span><br><span class="line">@wilma = <span class="keyword">undef</span>;</span><br><span class="line"><span class="keyword">say</span> <span class="keyword">scalar</span> @wilma;</span><br><span class="line"></span><br><span class="line">@betty = ();</span><br><span class="line"><span class="keyword">say</span> <span class="keyword">scalar</span> @betty;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-15.png"></p>
<p>前两行将一个标量复制给列表，实际上得到了只含有一个元素的列表。</p>
<p>saclar是一个伪函数，其作用是告诉解释器使用标量上下文。<br>此外，清空列表应该使用(),因为undef本身是一个标量，如果将其复制给列表，将得到只含有一个“undef”元素的列表，而非一个空列表；</p>
<h4 id="列表上下文中的"><a href="#列表上下文中的" class="headerlink" title="列表上下文中的&lt;STDIN&gt;"></a>列表上下文中的&lt;STDIN&gt;</h4><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">chomp</span>(@list = &lt;STDIN&gt;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;Got list:@list&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>将标准输入流赋值给列表变量，每次回车后输入新元素，使用ctrl+D来告诉程序输入结束。</p>
<p><img src="/2024/05/08/LearnPerl/image-16.png"></p>
<h3 id="习题"><a href="#习题" class="headerlink" title="习题"></a>习题</h3><p><img src="/2024/05/08/LearnPerl/image-17.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">chomp</span>(@list = &lt;STDIN&gt;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> <span class="keyword">reverse</span> @list;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image-19.png" alt="alt text"></p>
<p><img src="/2024/05/08/LearnPerl/image-18.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@name = <span class="keyword">qw</span> /fred betty barney dino wilma pebbles bamm-bamm /;</span><br><span class="line"></span><br><span class="line"><span class="keyword">chomp</span>(@numbers = &lt;STDIN&gt;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> $number (@numbers)&#123;</span><br><span class="line">    <span class="keyword">if</span> (@name[$number])&#123;</span><br><span class="line">        <span class="keyword">say</span> @name[$number];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image-20.png"></p>
<p><img src="/2024/05/08/LearnPerl/image-21.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">@list = &lt;STDIN&gt;;</span><br><span class="line"></span><br><span class="line">@sorted = <span class="keyword">sort</span> @list;</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> @sorted;</span><br><span class="line"><span class="keyword">chomp</span>(@sorted);</span><br><span class="line"><span class="keyword">say</span> @sorted;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image-22.png"></p>
<h2 id="Ch4-子程序"><a href="#Ch4-子程序" class="headerlink" title="Ch4 子程序"></a>Ch4 子程序</h2><p>Perl语言支持用户自定义的子程序：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">marine</span> </span>&#123;</span><br><span class="line"> $n += <span class="number">1</span>; <span class="comment"># Global variable $n</span></span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;Hello, sailor number $n!\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&amp;marine; <span class="comment"># says Hello, sailor number 1!</span></span><br><span class="line">&amp;marine; <span class="comment"># says Hello, sailor number 2!</span></span><br><span class="line">&amp;marine; <span class="comment"># says Hello, sailor number 3!</span></span><br><span class="line">&amp;marine; <span class="comment"># says Hello, sailor number 4!</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">sum_of_fred_and_barney</span> </span>&#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;Hey, you called the sum_of_fred_and_barney subroutine!\n&quot;</span>;</span><br><span class="line"> $fred + $barney; <span class="comment"># That&#x27;s the return value</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$fred = <span class="number">3</span>;</span><br><span class="line">$barney = <span class="number">4</span>;</span><br><span class="line">$wilma = &amp;sum_of_fred_and_barney; <span class="comment"># $wilma gets 7</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;\$wilma is $wilma.\n&quot;</span>;</span><br><span class="line">$betty = <span class="number">3</span> * &amp;sum_of_fred_and_barney; <span class="comment"># $betty gets 21</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;\$betty is $betty.\n&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>上述程序中，sub用于定义函数名。同时我们可以注意到，如果不加限定，子程序中定义的变量是全局变量。</p>
<p>此外，Perl的所有函数都默认含有返回值。并且返回值是子程序中最后一次进行解析的元素。</p>
<p>需要注意的是，返回值一定是<strong>最后一次进行解析的元素</strong>，如果最后一行语句是类似Print这样的调用，那么返回值为1.</p>
<p>下面的例子中：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">larger_of_fred_or_barney</span> </span>&#123;</span><br><span class="line"> <span class="keyword">if</span> ($fred &gt; $barney) &#123;</span><br><span class="line"> $fred;</span><br><span class="line"> &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"> $barney;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>返回的是比较操作的最大值，而不是最后一行。</p>
<h4 id="变量传递"><a href="#变量传递" class="headerlink" title="变量传递"></a>变量传递</h4><p>调用函数时，很多场景下需要传递变量。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">max</span> </span>&#123;</span><br><span class="line"> <span class="comment"># Compare this to &amp;larger_of_fred_or_barney</span></span><br><span class="line"><span class="keyword">if</span> ($_[<span class="number">0</span>] &gt; $_[<span class="number">1</span>]) &#123;</span><br><span class="line">    $_[<span class="number">0</span>];&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    $_[<span class="number">1</span>];&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> &amp;max(<span class="number">7</span>,-<span class="number">9</span>,<span class="number">8</span>);</span><br><span class="line"><span class="keyword">say</span> &amp;max;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image-24.png"></p>
<p>在子程序中，默认调用$_作为参数数组，这个数字是一个局部变量。此外，Perl并不会检查调用时传递的参数是否符合设计时的预期，即使传递多余的变量或空的变量数组，子程序也能运行。</p>
<h4 id="子程序中的私有变量"><a href="#子程序中的私有变量" class="headerlink" title="子程序中的私有变量"></a>子程序中的私有变量</h4><p>如前所述，perl中的任何变量都默认为全局变量，而<code>my</code>关键字可以定义局部变量，也称词法变量(lexical variables)。局部变量被限制在最近封闭块{}或文件中。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">max</span> </span>&#123;</span><br><span class="line"> <span class="keyword">my</span>($m, $n); <span class="comment"># new, private variables for this block</span></span><br><span class="line"> ($m, $n) = @_; <span class="comment"># give names to the parameters</span></span><br><span class="line"> <span class="keyword">if</span> ($m &gt; $n) &#123; $m &#125; <span class="keyword">else</span> &#123; $n &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>由于Perl的设计原则是，<strong>如无必要，不设限制</strong>，因此函数的变量列表是十分自由的，一个更好的Max函数设计如下：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">$maximum = &amp;max(<span class="number">3</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">6</span>);</span><br><span class="line"><span class="keyword">say</span> $maximum;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">max</span> </span>&#123;</span><br><span class="line"> <span class="keyword">my</span>($max_so_far) = <span class="keyword">shift</span> @_; <span class="comment"># the first one is the largest yet seen</span></span><br><span class="line"> <span class="keyword">foreach</span> (@_) &#123; <span class="comment"># look at the remaining arguments</span></span><br><span class="line"> <span class="keyword">if</span> ($_ &gt; $max_so_far) &#123; <span class="comment"># could this one be bigger yet?</span></span><br><span class="line"> $max_so_far = $_;</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> $max_so_far;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-25.png"></p>
<p>同时我们可以注意到，子程序不一定要先定义后调用，而是可以在调用之后定义。</p>
<p>此外需要注意的是，<code>my</code>关键字通常只定义它后面的一个变量，除非加上括号：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">my</span> $fred, $barney; <span class="comment"># WRONG! Fails to declare $barney</span></span><br><span class="line"><span class="keyword">my</span>($fred, $barney); <span class="comment"># declares both</span></span><br></pre></td></tr></table></figure>

<p>如果没有<code>&#123;&#125;</code>这样的封闭块，那么文件本身被看作一个封闭块。不同文件中的同名变量是不同的局部变量。</p>
<h4 id="use-strict-编译指令"><a href="#use-strict-编译指令" class="headerlink" title="use strict 编译指令"></a>use strict 编译指令</h4><p>由于Perl的语法限制过于宽松，有时可能会导致大型程序的错误难以定位。此时可以通过<code>use strict</code>关键字来使语法更加严谨。打开strict后，任何变量在使用前都需要先进行<code>my</code>关键字的定义。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="comment">#use strict;</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">12</span>;</span><br><span class="line"><span class="keyword">my</span> $bamm_bamm = <span class="number">3</span>; <span class="comment"># New lexical variable</span></span><br><span class="line"></span><br><span class="line">$bammbamm += <span class="number">1</span>; <span class="comment"># No such variable: Compile time fatal error</span></span><br></pre></td></tr></table></figure>

<p>使用<code>use v5.12</code>和使用<code>use strict</code>的效果相同。</p>
<p><img src="/2024/05/08/LearnPerl/image-26.png"></p>
<p>当程序规模变大时，最后使用strict。一般来讲，任何超过一个屏幕长的程序都应该使用strict.</p>
<h4 id="返回-return"><a href="#返回-return" class="headerlink" title="返回 return"></a>返回 return</h4><p>在某些情况下需要提前终止子程序，这是就用到了关键字<code>return</code>：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="comment">#use strict;</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">12</span>;</span><br><span class="line"><span class="keyword">my</span> @names = <span class="keyword">qw</span>/ fred barney betty dino wilma pebbles bamm-bamm /;</span><br><span class="line"><span class="keyword">my</span> $result = &amp;which_element_is(<span class="string">&quot;dino&quot;</span>, @names);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">which_element_is</span> </span>&#123;</span><br><span class="line">    <span class="keyword">my</span>($what, @array) = @_;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="number">0</span>..$#array) &#123; <span class="comment"># indices of @array&#x27;s elements</span></span><br><span class="line">        <span class="keyword">if</span> ($what eq $array[$_]) &#123;</span><br><span class="line">            <span class="keyword">return</span> $_; <span class="comment"># return early once found</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">-<span class="number">1</span>; <span class="comment"># element not found (return is optional here)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-27.png"></p>
<h4 id="省略-符号"><a href="#省略-符号" class="headerlink" title="省略&amp;符号"></a>省略&amp;符号</h4><p>一些情况下在函数调用时可以省略前面的&amp;符号。</p>
<p>然而，如果函数的命名正好与Perl的内置函数同名，那么调用时必须加上<code>&amp;</code>符号，否则无法区分自己定义的函数和内置函数，而Perl会默认调用内置函数。</p>
<h4 id="非标量输出"><a href="#非标量输出" class="headerlink" title="非标量输出"></a>非标量输出</h4><p>如果在一些情况下，函数需要返回一个非标量的输出，即，一个列表。<br>如果在列表上下文中，这种操作是完全没问题的。例如如果想要改进<code>..</code>操作，使其能够产生递减的列表：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">list_from_fred_to_barney</span> </span>&#123;</span><br><span class="line"> <span class="keyword">if</span> ($fred &lt; $barney) &#123;</span><br><span class="line"> <span class="comment"># Count upwards from $fred to $barney</span></span><br><span class="line"> $fred..$barney;</span><br><span class="line"> &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"> <span class="comment"># Count downwards from $fred to $barney</span></span><br><span class="line"> <span class="keyword">reverse</span> $barney..$fred;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">$fred = <span class="number">11</span>;</span><br><span class="line">$barney = <span class="number">6</span>;</span><br><span class="line">@c = &amp;list_from_fred_to_barney; <span class="comment"># @c gets (11, 10, 9, 8, 7, 6)</span></span><br><span class="line"><span class="keyword">say</span> @c;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-28.png"></p>
<h4 id="持续变量"><a href="#持续变量" class="headerlink" title="持续变量"></a>持续变量</h4><p>一个使用<code>my</code>关键字定义的变量是局部变量，且在每次调用时都被重置。如果想维护一个持续的局部变量，则可以使用<code>state</code>关键字：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line">running_sum( <span class="number">5</span>, <span class="number">6</span> );</span><br><span class="line">running_sum( <span class="number">1</span>..<span class="number">3</span> );</span><br><span class="line">running_sum( <span class="number">4</span> );</span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">running_sum</span> </span>&#123;</span><br><span class="line"> <span class="keyword">state</span> $sum = <span class="number">0</span>;</span><br><span class="line"> <span class="keyword">state</span> @numbers;</span><br><span class="line"> <span class="keyword">foreach</span> <span class="keyword">my</span> $number ( @_ ) &#123;</span><br><span class="line"> <span class="keyword">push</span> @numbers, $number;</span><br><span class="line"> $sum += $number;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">say</span> <span class="string">&quot;The sum of (@numbers) is $sum&quot;</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-29.png"></p>
<h4 id="子函数签名subroutine-signatures"><a href="#子函数签名subroutine-signatures" class="headerlink" title="子函数签名subroutine signatures"></a>子函数签名subroutine signatures</h4><p>在perl的5.20以后版本，引入了该特性()。使得函数可以像C语言那样定义，同时为变量设置默认值：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">20</span>;</span><br><span class="line"><span class="keyword">use</span> strict;</span><br><span class="line"><span class="keyword">use</span> warnings;</span><br><span class="line"><span class="keyword">use</span> experimental <span class="string">&#x27;signatures&#x27;</span>;  <span class="comment"># 启用子程序签名功能</span></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">list_from_fred_to_barney</span> (  $<span class="title">fred</span> = 0,  $<span class="title">barney</span> = 7 ) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ($fred &lt; $barney) &#123; $fred..$barney &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123; <span class="keyword">reverse</span> $barney..$fred &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">my</span> @defaults = list_from_fred_to_barney();</span><br><span class="line"><span class="keyword">my</span> @default_end = list_from_fred_to_barney( <span class="number">17</span> );</span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;defaults: @defaults&quot;</span>;</span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;default_end: @default_end&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-30.png"></p>
<h3 id="习题-1"><a href="#习题-1" class="headerlink" title="习题"></a>习题</h3><p><img src="/2024/05/08/LearnPerl/image-31.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">total</span></span>&#123;</span><br><span class="line">    <span class="keyword">my</span> $sum;</span><br><span class="line">    <span class="keyword">foreach</span> (@_)&#123;</span><br><span class="line">        $sum += $_;</span><br><span class="line">    &#125;</span><br><span class="line">    $sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> @fred = <span class="string">qw&#123; 1 3 5 7 9 &#125;</span>;</span><br><span class="line"><span class="keyword">my</span> $fred_total = total(@fred);</span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;The total of \@fred is $fred_total.\n&quot;</span>;</span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;Enter some numbers on separate lines: &quot;</span>;</span><br><span class="line"><span class="keyword">my</span> $user_total = total(&lt;STDIN&gt;);</span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;The total of those numbers is $user_total.\n&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-32.png"></p>
<p><img src="/2024/05/08/LearnPerl/image-33.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">total</span></span>&#123;</span><br><span class="line">    <span class="keyword">my</span> $sum;</span><br><span class="line">    <span class="keyword">foreach</span> (@_)&#123;</span><br><span class="line">        $sum += $_;</span><br><span class="line">    &#125;</span><br><span class="line">    $sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> total(<span class="number">1</span>..<span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-34.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">average</span></span>&#123;</span><br><span class="line">    <span class="keyword">my</span> $sum;</span><br><span class="line">    <span class="keyword">foreach</span>(@_)&#123;</span><br><span class="line">        $sum += $_;</span><br><span class="line">    &#125;</span><br><span class="line">    $sum/@_;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">above_average</span></span>&#123;</span><br><span class="line">    <span class="keyword">my</span> @above;</span><br><span class="line">    <span class="keyword">my</span> $average = average(@_);</span><br><span class="line">    <span class="keyword">foreach</span>(@_)&#123;</span><br><span class="line">        <span class="keyword">if</span>($_ &gt; $average)&#123;</span><br><span class="line">             <span class="keyword">push</span> @above,$_;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    @above;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> @fred = above_average(<span class="number">1</span>..<span class="number">10</span>);</span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;\@fred is @fred\n&quot;</span>;</span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;(Should be 6 7 8 9 10)\n&quot;</span>;</span><br><span class="line"><span class="keyword">my</span> @barney = above_average(<span class="number">100</span>, <span class="number">1</span>..<span class="number">10</span>);</span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;\@barney is @barney\n&quot;</span>;</span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;(Should be just 100)\n&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-35.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">greet</span></span>&#123;</span><br><span class="line">    <span class="keyword">state</span> $here;</span><br><span class="line">    <span class="keyword">if</span> ($here)&#123;</span><br><span class="line">        <span class="keyword">say</span> <span class="string">&quot;Hi @_[0]! $here is also here!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">say</span> <span class="string">&quot;Hi @_[0]! You are the first one here!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    $here = @_[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">greet( <span class="string">&quot;Fred&quot;</span> );</span><br><span class="line">greet( <span class="string">&quot;Barney&quot;</span> );</span><br><span class="line">greet( <span class="string">&quot;Wilma&quot;</span> );</span><br><span class="line">greet( <span class="string">&quot;Betty&quot;</span> );</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-36.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">greet</span></span>&#123;</span><br><span class="line">    <span class="keyword">state</span> @here;</span><br><span class="line">    <span class="keyword">if</span> (@here)&#123;</span><br><span class="line">        <span class="keyword">say</span> <span class="string">&quot;Hi @_[0]! I&#x27;ve seen: @here&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">say</span> <span class="string">&quot;Hi @_[0]! You are the first one here!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">push</span> @here,   @_[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">greet( <span class="string">&quot;Fred&quot;</span> );</span><br><span class="line">greet( <span class="string">&quot;Barney&quot;</span> );</span><br><span class="line">greet( <span class="string">&quot;Wilma&quot;</span> );</span><br><span class="line">greet( <span class="string">&quot;Betty&quot;</span> );</span><br></pre></td></tr></table></figure>

<h2 id="Ch5-输入-输出"><a href="#Ch5-输入-输出" class="headerlink" title="Ch5 输入&#x2F;输出"></a>Ch5 输入&#x2F;输出</h2><h3 id="标准输入流"><a href="#标准输入流" class="headerlink" title="标准输入流"></a>标准输入流</h3><p>如前所述，标准输入流为&lt;STDIN&gt;。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (&lt;STDIN&gt;) &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;I saw $_&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (&lt;STDIN&gt;) &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;I saw $_&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面的2种循环的执行逻辑是不同的，while是标量上下文，而foreach是列表上下文：</p>
<p><img src="/2024/05/08/LearnPerl/image-37.png"></p>
<h4 id="钻石符号"><a href="#钻石符号" class="headerlink" title="钻石符号&lt;&gt;"></a>钻石符号&lt;&gt;</h4><p>两个尖括号<code>&lt;&gt;</code>称作钻石符号，同样也用于标准输入。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (&lt;&gt;) &#123;</span><br><span class="line"> <span class="keyword">chomp</span>;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;It was $_ that I saw!\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-38.png"></p>
<p>钻石符号的作用在于可以指定调用参数，从文件中读取标准输入。</p>
<p>一般而言，钻石符号在程序中使用一次就够了，其他多余的调用往往意味着错误。</p>
<h4 id="双钻石符号"><a href="#双钻石符号" class="headerlink" title="双钻石符号 &lt;&lt;&gt;&gt;"></a>双钻石符号 &lt;&lt;&gt;&gt;</h4><p>单钻石符号的问题在于，在输入参数含义特殊字符时可能出问题。</p>
<p>例如会将<code>|</code>操作符当作Pipe处理：</p>
<p><img src="/2024/05/08/LearnPerl/image-39.png"></p>
<p>而5.22之后的版本使用双钻石符号修复该问题：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"><span class="keyword">while</span> (&lt;&lt;&gt;&gt;) &#123;</span><br><span class="line"> <span class="keyword">chomp</span>;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;It was $_ that I saw!\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="调用参数列表"><a href="#调用参数列表" class="headerlink" title="调用参数列表"></a>调用参数列表</h4><p>perl中的调用参数存储在一个内置列表<code>@ARGV</code>中。可以对上述列表进行单独操作。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">pop</span> @ARGV;</span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;The invocation augments are: @ARGV&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (&lt;&lt;&gt;&gt;) &#123;</span><br><span class="line"> <span class="keyword">chomp</span>;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;It was $_ that I saw!\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image-40.png"></p>
<h4 id="标准输出"><a href="#标准输出" class="headerlink" title="标准输出"></a>标准输出</h4><p><code>print</code>函数被用作标准输出。</p>
<p>在对列表进行print时，有直接print和插值print2种不同方式：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">$&quot; = <span class="string">&#x27;,&#x27;</span>;</span><br><span class="line">@array =  ( <span class="string">&quot;fred\n&quot;</span>,<span class="string">&quot;barney\n&quot;</span>,<span class="string">&quot;betty\n&quot;</span>   );</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> @array; <span class="comment"># print a list of items</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;@array&quot;</span>; <span class="comment"># print a string (containing an interpolated array)</span></span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-41.png"></p>
<p>区别在于，直接print会将列表合并成一整个字符串进行输出，而插值会在每个列表元素之间插入一个指定字符后输出。</p>
<p>需要插值的字符串保存在Perl的内置变量<code>$&quot;</code>中，默认为一个空格。</p>
<h4 id="括号"><a href="#括号" class="headerlink" title="括号"></a>括号</h4><p>在不影响上下文的情况下perl中的括号都可以省略。</p>
<p>然而，有些情况下，省略括号会得到奇怪的结果：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> (<span class="number">2</span>+<span class="number">3</span>)*<span class="number">4</span>; <span class="comment"># Oops!</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> (<span class="keyword">say</span> (<span class="number">2</span>+<span class="number">3</span>)*<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">(<span class="keyword">say</span> (<span class="number">2</span>+<span class="number">3</span>)*<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span>( (<span class="number">2</span>+<span class="number">3</span>) * <span class="number">4</span> );</span><br></pre></td></tr></table></figure>
<p>上述程序输出如下结果：<br><img src="/2024/05/08/LearnPerl/image-42.png"></p>
<p>第一行输出5，这是因为perl会先计算2+3，然后执行say,得到5，同时返回结果为1，将1乘4得到4，但是并没有对4进行任何后续操作。</p>
<p>第二行输出5 4，验证了这一结果。</p>
<p>同理，第三行输出5，只有添加了正确的括号才得到预期的结果。</p>
<h4 id="格式化输出printf"><a href="#格式化输出printf" class="headerlink" title="格式化输出printf"></a>格式化输出printf</h4><p>perl提供了和C语言相同的格式化输出方式printf:</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">printf</span> <span class="string">&quot;Hello, %s; your password expires in %d days!\n&quot;</span>,$user, $days_to_die;</span><br><span class="line"><span class="keyword">printf</span> <span class="string">&quot;%g %g %g\n&quot;</span>, <span class="number">5</span>/<span class="number">2</span>, <span class="number">51</span>/<span class="number">17</span>, <span class="number">51</span> ** <span class="number">17</span>; <span class="comment"># 2.5 3 1.0683e+29</span></span><br><span class="line"><span class="keyword">printf</span> <span class="string">&quot;in %x days!\n&quot;</span>, <span class="number">17</span>; <span class="comment"># in 0x11 days!</span></span><br><span class="line"><span class="keyword">printf</span> <span class="string">&quot;in %o days!\n&quot;</span>, <span class="number">17</span>; <span class="comment"># in 021 days!</span></span><br><span class="line"><span class="keyword">printf</span> <span class="string">&quot;%10s\n&quot;</span>, <span class="string">&quot;wilma&quot;</span>; <span class="comment"># looks like `````wilma</span></span><br><span class="line"><span class="keyword">printf</span> <span class="string">&quot;%12f\n&quot;</span>, <span class="number">6</span> * <span class="number">7</span> + <span class="number">2</span>/<span class="number">3</span>; <span class="comment"># looks like ```42.666667</span></span><br><span class="line"><span class="keyword">printf</span> <span class="string">&quot;%12.3f\n&quot;</span>, <span class="number">6</span> * <span class="number">7</span> + <span class="number">2</span>/<span class="number">3</span>; <span class="comment"># looks like ``````42.667</span></span><br><span class="line"><span class="keyword">printf</span> <span class="string">&quot;%12.0f\n&quot;</span>, <span class="number">6</span> * <span class="number">7</span> + <span class="number">2</span>/<span class="number">3</span>; <span class="comment"># looks like ``````````43</span></span><br></pre></td></tr></table></figure>

<p>其中%g会自动选择较为合适的输出格式。</p>
<h4 id="列表与printf"><a href="#列表与printf" class="headerlink" title="列表与printf"></a>列表与printf</h4><p>对于一个不定长的列表，使用格式化输出可能比较困难，但是借助perl的标量上下文特性可以轻松做到：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"><span class="keyword">my</span> @items = <span class="string">qw( wilma dino pebbles )</span>;</span><br><span class="line"><span class="keyword">printf</span> <span class="string">&quot;The items are:\n&quot;</span>.(<span class="string">&quot;%10s\n&quot;</span> <span class="keyword">x</span> @items), @items;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-43.png"></p>
<h3 id="文件句柄-filehandles"><a href="#文件句柄-filehandles" class="headerlink" title="文件句柄 filehandles"></a>文件句柄 filehandles</h3><p>perl 通过文件句柄方式来操作文件：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">open</span> CONFIG, <span class="string">&#x27;dino&#x27;</span>;</span><br><span class="line"><span class="keyword">open</span> CONFIG, <span class="string">&#x27;&lt;dino&#x27;</span>;</span><br><span class="line"><span class="keyword">open</span> BEDROCK, <span class="string">&#x27;&gt;fred&#x27;</span>;</span><br><span class="line"><span class="keyword">open</span> LOG, <span class="string">&#x27;&gt;&gt;logfile&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>为了不与一些内建函数冲突，最好是使用全大写的方式命名文件句柄。</p>
<p>在perl中，仅有6个内建的大写变量：STDIN, STDOUT, STDERR, DATA, ARGV, and ARGVOUT</p>
<p>打开文件的方式分为：</p>
<ol>
<li><code>&lt;</code> 读取</li>
<li><code>&gt;</code> 写入</li>
<li><code>&gt;&gt;</code>追加写入</li>
</ol>
<p>在5.6之后的版本也支持：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">open</span> CONFIG, <span class="string">&#x27;&lt;&#x27;</span>, <span class="string">&#x27;dino&#x27;</span>;</span><br><span class="line"><span class="keyword">open</span> BEDROCK, <span class="string">&#x27;&gt;&#x27;</span>, $file_name;</span><br><span class="line"><span class="keyword">open</span> LOG, <span class="string">&#x27;&gt;&gt;&#x27;</span>, &amp;logfile_name();</span><br></pre></td></tr></table></figure>

<p>这么做的的好吃是，对文件的操作方式更加明确，并且可以指定文件的编码类型：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">open</span> BEDROCK, <span class="string">&#x27;&gt;:encoding(UTF-8)&#x27;</span>, $file_name;</span><br><span class="line"><span class="keyword">open</span> LOG, <span class="string">&#x27;&gt;&gt;:encoding(UTF-8)&#x27;</span>, &amp;logfile_name();</span><br></pre></td></tr></table></figure>

<p><code>perl -MEncode -le &quot;print for Encode-&gt;encodings(&#39;:all&#39;)&quot;</code>可以打印出所有的编码方式：<br><img src="/2024/05/08/LearnPerl/image-44.png"></p>
<p>对于打开遇到错误的文件句柄，会被设置为<code>undef</code>。</p>
<h3 id="二进制格式binmode"><a href="#二进制格式binmode" class="headerlink" title="二进制格式binmode"></a>二进制格式binmode</h3><p>假设我们有一个脚本需要将数据写入标准输出和标准错误输出，并且我们希望数据保持原样，不进行任何换行符转换。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> strict;</span><br><span class="line"><span class="keyword">use</span> warnings;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将 STDOUT 和 STDERR 切换到二进制模式</span></span><br><span class="line"><span class="keyword">binmode</span> STDOUT;  <span class="comment"># don&#x27;t translate line endings</span></span><br><span class="line"><span class="keyword">binmode</span> STDERR;  <span class="comment"># don&#x27;t translate line endings</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出一些数据</span></span><br><span class="line"><span class="keyword">print</span> STDOUT <span class="string">&quot;Hello, World!\n&quot;</span>;</span><br><span class="line"><span class="keyword">print</span> STDERR <span class="string">&quot;Error: Something went wrong!\n&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>在没有 binmode STDOUT; 和 binmode STDERR; 的情况下，在 Windows 系统上运行这个脚本可能会将 \n 转换为 \r\n，导致输出中有额外的回车符。而使用了 binmode 后，这些换行符将保持不变，确保输出的一致性。</p>
<p>假设我们需要从一个 UTF-8 编码的文件中读取数据，并正确处理其中的 Unicode 字符。<br>首先，我们创建一个包含 Unicode 字符的文件 input.txt：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">你好，世界！</span><br><span class="line">Hello, World!</span><br></pre></td></tr></table></figure>
<p>然后，我们编写一个 Perl 脚本来读取并输出这个文件的内容：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> strict;</span><br><span class="line"><span class="keyword">use</span> warnings;</span><br><span class="line"><span class="keyword">use</span> utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置输入和输出的编码</span></span><br><span class="line"><span class="keyword">binmode</span> STDOUT, <span class="string">&#x27;:encoding(UTF-8)&#x27;</span>;  <span class="comment"># 设置标准输出为 UTF-8 编码</span></span><br><span class="line"><span class="keyword">binmode</span> STDERR, <span class="string">&#x27;:encoding(UTF-8)&#x27;</span>;  <span class="comment"># 设置标准错误输出为 UTF-8 编码</span></span><br><span class="line"><span class="keyword">binmode</span> STDIN, <span class="string">&#x27;:encoding(UTF-8)&#x27;</span>;   <span class="comment"># 设置标准输入为 UTF-8 编码</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> $fh;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开输入文件</span></span><br><span class="line"><span class="keyword">if</span> (! (<span class="keyword">open</span> <span class="keyword">my</span> $fh, <span class="string">&#x27;&lt;:encoding(UTF-8)&#x27;</span>, <span class="string">&#x27;input.txt&#x27;</span>) )&#123;</span><br><span class="line">     <span class="keyword">die</span> <span class="string">&quot;Cannot open file: $!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 读取文件内容并处理</span></span><br><span class="line"><span class="keyword">while</span> (<span class="keyword">my</span> $line = &lt;$fh&gt;) &#123;</span><br><span class="line">    <span class="keyword">if</span> ($line =~ <span class="regexp">/Hello/</span>) &#123;</span><br><span class="line">        <span class="keyword">print</span> STDOUT <span class="string">&quot;Found: $line&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">print</span> STDERR <span class="string">&quot;Not found: $line&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">close</span> $fh;</span><br></pre></td></tr></table></figure>

<p>在这个脚本中，我们对标准输入、标准输出和标准错误输出都设置了 UTF-8 编码。这样我们可以确保：<br>从文件中读取的数据是正确解码的 Unicode 字符。<br>输出的数据也会被正确编码为 UTF-8，确保在不同平台上输出的一致性。</p>
<h4 id="结束句柄"><a href="#结束句柄" class="headerlink" title="结束句柄"></a>结束句柄</h4><p>如上所述，每个open 操作最好带有一个close操作。</p>
<h4 id="die用于处理致命错误"><a href="#die用于处理致命错误" class="headerlink" title="die用于处理致命错误"></a>die用于处理致命错误</h4><p>如上述程序所示，可以用die来处理致命错误。系统的报错信息和行号会被自动存储在<code>$!</code>变量中。</p>
<p>此外可以把<code>die</code>换成<code>warn</code>函数来生成警告，区别在于不会结束进程而是打印警告信息。</p>
<p>此外在5.10后的版本还可以通过添加<code>use autodie；</code>来使程序自动退出，从而省去了检查。</p>
<h4 id="文件句柄的使用"><a href="#文件句柄的使用" class="headerlink" title="文件句柄的使用"></a>文件句柄的使用</h4><p>文件句柄的使用，可以将其放入尖括号中：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( ! <span class="keyword">open</span> PASSWD, <span class="string">&quot;/etc/passwd&quot;</span>) &#123;</span><br><span class="line"> <span class="keyword">die</span> <span class="string">&quot;How did you get logged in? ($!)&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (&lt;PASSWD&gt;) &#123;</span><br><span class="line"> <span class="keyword">chomp</span>;</span><br><span class="line"> ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此外，如果是以写入方式打开的句柄，可以通过在printf 后直接写上文件句柄的方式来将其写入到对应文件：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"><span class="keyword">use</span> autodie;</span><br><span class="line"></span><br><span class="line"><span class="keyword">open</span> LOG, <span class="string">&#x27;&gt;&gt;&#x27;</span>, <span class="string">&#x27;logfile&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> LOG <span class="string">&quot;Captain&#x27;s log, stardate 3.14159\n&quot;</span>; <span class="comment"># output goes to LOG</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> LOG;</span><br><span class="line"><span class="keyword">printf</span> <span class="string">&quot;I hope Mr. Slate doesn&#x27;t find out about this.\n&quot;</span>;</span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;Wilma!\n&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>如果不指定print或printf的输出句柄，其默认会输出到STDOUT，也就是用户的显示屏。</p>
<p>然而可以通过select的方式指定输出的位置，从而改变输出目的地。</p>
<h4 id="重新打开文件句柄"><a href="#重新打开文件句柄" class="headerlink" title="重新打开文件句柄"></a>重新打开文件句柄</h4><p>如果重新打开一个文件句柄，Perl会先关闭前一个，然后打开一个新的，因此，可以重新指定perl的标准文件句柄，从而使一些信息输出到指定的地方。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Send errors to my private error log</span></span><br><span class="line"><span class="keyword">if</span> ( ! <span class="keyword">open</span> STDERR, <span class="string">&quot;&gt;&gt;/home/barney/.error_log&quot;</span>) &#123;</span><br><span class="line"> <span class="keyword">die</span> <span class="string">&quot;Can&#x27;t open error log for append: $!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="标量变量的句柄"><a href="#标量变量的句柄" class="headerlink" title="标量变量的句柄"></a>标量变量的句柄</h4><p>perl支持将文件句柄保存在标量变量中：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"><span class="keyword">use</span> autodie;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">open</span> <span class="keyword">my</span> $rocks_fh, <span class="string">&#x27;&gt;&gt;&#x27;</span>, <span class="string">&#x27;rocks.txt&#x27;</span></span><br><span class="line">  <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">&quot;Could not open rocks.txt: $!&quot;</span>;</span><br><span class="line"><span class="keyword">foreach</span> <span class="keyword">my</span> $rock ( <span class="string">qw( slate lava granite )</span> ) &#123;</span><br><span class="line">    <span class="keyword">say</span> $rocks_fh $rock</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">print</span> $rocks_fh <span class="string">&quot;limestone\n&quot;</span>;</span><br><span class="line"><span class="keyword">close</span> $rocks_fh;</span><br></pre></td></tr></table></figure>

<p>将句柄保存为标量，好处是可以用函数对其进行处理，同时作用域更加明确。</p>
<p>此外注意<code>say</code>和<code>print</code>的位置是没有逗号的，因为执行的是文件写入操作。</p>
<p>如果将文件句柄当作标量打印，得到的结果会很奇怪。</p>
<p>解决方案是将文件句柄用花括号括起来(创建一个独立的域)。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">print</span> &#123; $rocks_fh &#125; <span class="string">&quot;sandstone\n&quot;</span>;</span><br><span class="line"><span class="keyword">print</span> &#123;$rocks_fh&#125; $_; </span><br></pre></td></tr></table></figure>

<h3 id="习题-2"><a href="#习题-2" class="headerlink" title="习题"></a>习题</h3><p><img src="/2024/05/08/LearnPerl/image-45.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> @stack;</span><br><span class="line"><span class="keyword">while</span> (&lt;&gt;)&#123;</span><br><span class="line">    <span class="keyword">push</span> @stack,$_;</span><br><span class="line">    <span class="keyword">chomp</span>(@stack)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> $temp = <span class="keyword">pop</span> @stack;</span><br><span class="line"><span class="keyword">while</span> (<span class="keyword">defined</span>($temp))&#123;</span><br><span class="line">    <span class="keyword">say</span> $temp;</span><br><span class="line">    $temp = <span class="keyword">pop</span> @stack;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image-46.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">chomp</span>(<span class="keyword">my</span> @list=&lt;STDIN&gt;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> ((<span class="number">0</span>..<span class="number">9</span>)x6);</span><br><span class="line"><span class="keyword">printf</span> <span class="string">&quot;%20s\n&quot;</span><span class="keyword">x</span>@list,@list;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-47.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;Please input your length:&quot;</span>;</span><br><span class="line"><span class="keyword">my</span> $length = &lt;STDIN&gt;;</span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;Please input your strings:&quot;</span>;</span><br><span class="line"><span class="keyword">chomp</span>(<span class="keyword">my</span> @list = &lt;STDIN&gt;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> (<span class="number">0</span>..$length);</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (@list)&#123;</span><br><span class="line">    <span class="keyword">say</span> <span class="string">&#x27; &#x27;</span><span class="keyword">x</span>($length-<span class="keyword">length</span>($_)).$_;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Ch6-哈希"><a href="#Ch6-哈希" class="headerlink" title="Ch6 哈希"></a>Ch6 哈希</h2><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p>哈希即一系列key-value的组合，可以通过key来管理、索引数据。<br><img src="/2024/05/08/LearnPerl/image-48.png"></p>
<p><img src="/2024/05/08/LearnPerl/image-49.png"><br>哈希中的数据通常是无序的，可以看作是一个桶中放着带有不同标签的元素。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> %family_name;</span><br><span class="line">$family_name&#123;<span class="string">&#x27;fred&#x27;</span>&#125; = <span class="string">&#x27;flintstone&#x27;</span>;</span><br><span class="line">$family_name&#123;<span class="string">&#x27;barney&#x27;</span>&#125; = <span class="string">&#x27;rubble&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> <span class="keyword">my</span> $person (<span class="string">qw&lt; barney fred &gt;</span>) &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;I&#x27;ve heard of $person $family_name&#123;$person&#125;.\n&quot;</span>;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> %some_hash = (<span class="string">&#x27;foo&#x27;</span>, <span class="number">35</span>, <span class="string">&#x27;bar&#x27;</span>, <span class="number">12.4</span>, <span class="number">2.5</span>, <span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;wilma&#x27;</span>, <span class="number">1.72</span>e3<span class="number">0</span>, <span class="string">&#x27;betty&#x27;</span>, <span class="string">&quot;bye\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> @array = %some_hash;</span><br><span class="line"><span class="keyword">say</span>  $some_hash&#123;<span class="number">2.5</span>&#125;;</span><br><span class="line"><span class="keyword">print</span> @array;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-51.png"></p>
<p>哈希变量用百分号<code>%</code>来定义。用大括号<code>&#123;&#125;</code>来索引。哈希变量可以展开赋值给列表，列表中元素的顺序可能与定义时不同，这是因为perl为了索引将元素进行了重新排序。</p>
<p>可以使用类似</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%ip_address = <span class="keyword">reverse</span> %host_name;</span><br></pre></td></tr></table></figure>

<p>的操作，将键值对进行反转，通过原来的值来查找对应的键。这么做的前提是所有键值对是一一对应的。如果有重复的则会进行覆盖。</p>
<h4 id="箭头符号"><a href="#箭头符号" class="headerlink" title="箭头符号 &#x3D;&gt;"></a>箭头符号 &#x3D;&gt;</h4><p>perl专门为哈希定义了一个符号<code>=&gt;</code>用于定义哈希表。<br>在使用箭头符号进行定义时，可以省略字符串两边的引号。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">my</span> %last_name = (</span><br><span class="line"> <span class="string">fred =&gt;</span> <span class="string">&#x27;flintstone&#x27;</span>,</span><br><span class="line"> <span class="string">dino =&gt;</span> <span class="keyword">undef</span>,</span><br><span class="line"> <span class="string">barney =&gt;</span> <span class="string">&#x27;rubble&#x27;</span>,</span><br><span class="line"> <span class="string">betty =&gt;</span> <span class="string">&#x27;rubble&#x27;</span>,</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span>;</span><br><span class="line"><span class="keyword">say</span> $last_name<span class="string">&#123;fred&#125;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="哈希函数"><a href="#哈希函数" class="headerlink" title="哈希函数"></a>哈希函数</h3><p>perl内建了很多函数来对哈希进行处理。</p>
<h4 id="keys-和-values"><a href="#keys-和-values" class="headerlink" title="keys 和 values"></a>keys 和 values</h4><p>keys 和values会分别返回哈希表的键和值的列表：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> %hash = (<span class="string">&#x27;a&#x27;</span> =&gt; <span class="number">1</span>, <span class="string">&#x27;b&#x27;</span> =&gt; <span class="number">2</span>, <span class="string">&#x27;c&#x27;</span> =&gt; <span class="number">3</span>);</span><br><span class="line"><span class="keyword">my</span> @k = <span class="keyword">keys</span> %hash;</span><br><span class="line"><span class="keyword">my</span> @v = <span class="keyword">values</span> %hash;</span><br><span class="line"><span class="keyword">my</span> $count = <span class="keyword">keys</span> %hash; <span class="comment"># gets 3, meaning three key-value pairs</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> @k;</span><br><span class="line"><span class="keyword">say</span> @v;</span><br><span class="line"><span class="keyword">say</span> $count;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-53.png"></p>
<p>在标量上下文中，2个函数都会直接返回元素的个数。</p>
<h4 id="each函数"><a href="#each函数" class="headerlink" title="each函数"></a>each函数</h4><p>each函数同样用在while循环中，来对哈希表的所有key-value对进行遍历。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> %hash = (<span class="string">&#x27;a&#x27;</span> =&gt; <span class="number">1</span>, <span class="string">&#x27;b&#x27;</span> =&gt; <span class="number">2</span>, <span class="string">&#x27;c&#x27;</span> =&gt; <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> ( <span class="keyword">my</span> ($key, $value) = <span class="keyword">each</span> %hash ) &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;$key =&gt; $value\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">say</span> <span class="string">&#x27;--------------&#x27;</span>;</span><br><span class="line"><span class="keyword">foreach</span> <span class="keyword">my</span> $key (<span class="keyword">sort</span> <span class="keyword">keys</span> %hash) &#123;</span><br><span class="line">    <span class="keyword">my</span> $value = $hash&#123;$key&#125;;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;$key =&gt; $value\n&quot;</span>;</span><br><span class="line">    <span class="comment"># Or, we could have avoided the extra $value variable:</span></span><br><span class="line">    <span class="comment"># print &quot;$key =&gt; $hash&#123;$key&#125;\n&quot;;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>由于哈希元素在内部的排序是无序的(或者说安装Perl内部的逻辑进行的)，可能与我们的预期不同，因此需要可能需要人工进行排序。</p>
<p><img src="/2024/05/08/LearnPerl/image-54.png"></p>
<h4 id="exist-delete和内插"><a href="#exist-delete和内插" class="headerlink" title="exist, delete和内插"></a>exist, delete和内插</h4><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> %books;</span><br><span class="line"></span><br><span class="line">$books&#123;<span class="string">&#x27;fred&#x27;</span>&#125; = <span class="number">3</span>;</span><br><span class="line">$books&#123;<span class="string">&#x27;wilma&#x27;</span>&#125; = <span class="number">1</span>;</span><br><span class="line">$books&#123;<span class="string">&quot;barney&quot;</span>&#125; = <span class="number">0</span>; <span class="comment"># no books currently checked out</span></span><br><span class="line">$books&#123;<span class="string">&quot;pebbles&quot;</span>&#125; = <span class="keyword">undef</span>; <span class="comment"># no books EVER checked out; a new library card</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">exists</span> $books&#123;<span class="string">&quot;dino&quot;</span>&#125;) &#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;Hey, there&#x27;s a library card for dino!\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;dino has no library card!\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> $person = <span class="string">&quot;barney&quot;</span>;</span><br><span class="line"><span class="keyword">delete</span> $books&#123;$person&#125;; </span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> <span class="keyword">my</span> $person (<span class="keyword">sort</span> <span class="keyword">keys</span> %books) &#123; <span class="comment"># each patron, in order</span></span><br><span class="line"> <span class="keyword">if</span> ($books&#123;$person&#125;) &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;$person has $books&#123;$person&#125; items\n&quot;</span>; <span class="comment"># fred has 3 items</span></span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image-55.png"><br><code>exist</code> 用于检查哈希表中元素是否存在，<code>delete</code>用于根据键来删除对应的键值对。</p>
<p>哈希变量同理可以内插进字符串中。</p>
<h4 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h4><p>perl通过%ENV这个特殊的哈希来访问系统的环境变量，只要在外部环境中设置过的变量，都可以通过该哈希进行访问：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;Path is $ENV&#123;PATH&#125;&quot;</span>;</span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;Display is $ENV&#123;DISPLAY&#125;&quot;</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image-56.png"></p>
<h3 id="习题-3"><a href="#习题-3" class="headerlink" title="习题"></a>习题</h3><p><img src="/2024/05/08/LearnPerl/image-57.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> %namelist = (</span><br><span class="line">    <span class="string">fred=&gt;</span><span class="string">&quot;flintstone&quot;</span>,</span><br><span class="line">    <span class="string">barney=&gt;</span><span class="string">&quot;rubble&quot;</span>,</span><br><span class="line">    <span class="string">wilma=&gt;</span><span class="string">&quot;flintstone&quot;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;input the name you want to know:&quot;</span>;</span><br><span class="line"><span class="keyword">while</span> (<span class="keyword">chomp</span>(<span class="keyword">my</span> $name = &lt;STDIN&gt;))&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">exists</span> $namelist&#123;$name&#125;)&#123;</span><br><span class="line">        <span class="keyword">say</span> <span class="string">&quot;$name &#x27;s family name is $namelist&#123;$name&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">say</span> <span class="string">&quot;sorry, I don&#x27;t konw a person named $name&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image-58.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> %wordlist;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(&lt;&gt;)&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">exists</span> $wordlist&#123;$_&#125;)&#123;</span><br><span class="line">        $wordlist&#123;$_&#125;+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        $wordlist&#123;$_&#125;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> ( <span class="keyword">sort</span> <span class="keyword">keys</span> %wordlist)&#123;</span><br><span class="line">    <span class="keyword">say</span> <span class="string">&quot;the word $_ appears $wordlist&#123;$_&#125; times&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image-59.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> ((<span class="string">&quot; &quot;</span>x7).<span class="string">&quot;KEY&quot;</span>.(<span class="string">&quot; &quot;</span>x85).<span class="string">&quot;VALUE&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span> <span class="keyword">my</span> $key (<span class="keyword">sort</span> <span class="keyword">keys</span> %ENV)&#123;</span><br><span class="line">     <span class="keyword">printf</span> <span class="string">&quot;%10s          %90s\n&quot;</span>,$key,$ENV&#123;$key&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Ch7-漫游正则表达式"><a href="#Ch7-漫游正则表达式" class="headerlink" title="Ch7 漫游正则表达式"></a>Ch7 漫游正则表达式</h2><h3 id="正则表达式的概念"><a href="#正则表达式的概念" class="headerlink" title="正则表达式的概念"></a>正则表达式的概念</h3><p>正则表达式用来检查一串字符串匹配或不匹配某种模式。 </p>
<p>对默认变量<code>$_</code>进行正则匹配，只需要将正则表达式写入斜线<code>//</code>内：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$_ = <span class="string">&quot;yabba dabba doo&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="regexp">/ba da/</span>) &#123; <span class="comment"># Does match</span></span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;It matched!\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>而对于一般的变量，则使用<code>=~</code>进行匹配：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$string =~ <span class="regexp">/pattern/</span>;</span><br></pre></td></tr></table></figure>

<p>perl的正则匹配默认是left most的，它会从左往右检查字符串，遇到第一个匹配的模式直接返回结果。</p>
<p>此外，正则表达式是大小写敏感的：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>( &lt;STDIN&gt; ) &#123;</span><br><span class="line"> <span class="keyword">chomp</span>;</span><br><span class="line"> <span class="keyword">if</span> ( <span class="regexp">/fred/</span> ) &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;\tMatches\n&quot;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span> &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;\tDoesn&#x27;t match\n&quot;</span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-60.png"></p>
<h3 id="通配"><a href="#通配" class="headerlink" title="通配"></a>通配</h3><p><code>.</code>符号可以匹配除了换行符以外的任何单个字符。</p>
<p>如果需要匹配一个真正的点号，则需要用反斜杠进行转义：<code>\.</code></p>
<p>同理为了匹配反斜杠，需要转义反斜杠本身：<code>\\</code>。</p>
<p><code> \N</code>也能达到和点号相同的效果。</p>
<h3 id="量词-，-m-n"><a href="#量词-，-m-n" class="headerlink" title="量词 *,?, +，{m,n}"></a>量词 <code>*</code>,<code>?</code>, <code>+</code>，<code>&#123;m,n&#125;</code></h3><p><code>?</code>表示前面的符号出现1次或0次。<br><code>*</code>表示前面的符号出现0次或多次。</p>
<p><code>.*</code>星号与点号搭配，即可表示出现0次或任意次数的任意字符，即可以匹配除了换号外的任意字符串。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>( &lt;STDIN&gt; ) &#123;</span><br><span class="line"> <span class="keyword">chomp</span>;</span><br><span class="line"> <span class="keyword">if</span> ( <span class="regexp">/.*/</span> ) &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;\tMatches\n&quot;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span> &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;\tDoesn&#x27;t match\n&quot;</span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image-61.png"></p>
<p>同时，这种匹配是贪婪的，它会匹配尽量长的部分。</p>
<p>由于星号可以匹配0次或多次，因此<code>.*</code>可以匹配空字符。</p>
<p>与之不同的是<code>+</code>号，可以匹配1次或多次。</p>
<p>想要匹配特定次数，则可以使用数字加大括号的组合，例如：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$_ = <span class="string">&quot;yabbbba dabbba doo.&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="regexp">/ab&#123;3&#125;a/</span>) &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;It matched!\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>同理可以通过大括号规定重复次数的区间：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$_ = <span class="string">&quot;yabbbba dabbba doo.&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="regexp">/ab&#123;2,3&#125;a/</span>) &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;It matched!\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上述代码表示b出现2到3次，也可以只规定上界或下界中的一个，另一个自动设置为0和无穷。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$_ = <span class="string">&quot;yabbbba dabbba doo.&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="regexp">/ab&#123;3,&#125;a/</span>) &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;It matched!\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>关于量词的总结如下：<br><img src="/2024/05/08/LearnPerl/image-62.png"></p>
<h3 id="模式分组-与反向引用g"><a href="#模式分组-与反向引用g" class="headerlink" title="模式分组 ()与反向引用g{}"></a>模式分组 <code>()</code>与反向引用<code>g&#123;&#125;</code></h3><p>量词只能作用于它前面一项，如果想让量词作用于多个字符，则可以通过小括号<code>()</code>对量词进行模式分组。</p>
<p>通过反斜杠加数字的办法可以和括号配合实现反向引用<code>\1</code>。反向引用是指前面的括号中匹配到的模式。例如：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$_ = <span class="string">&quot;abba&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="regexp">/(.)\1/</span>) &#123; <span class="comment"># matches &#x27;bb&#x27;</span></span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;It matched same character next to itself!\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以匹配任何一个重复2次的相同字符。</p>
<p>反向引用不必紧跟着括号：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$_ = <span class="string">&quot;yabba dabba doo&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="regexp">/y(....) d\1/</span>) &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;It matched the same after y and d!\n&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>在这里反斜杠后面的数字代表的是被匹配到的模式序号，而非重复的次数。被匹配到的顺序是按照左括号来计算的：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$_ = <span class="string">&quot;yabba dabba doo&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="regexp">/y((.)(.)\3\2) d\1/</span>) &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;It matched!\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上述表达的问题在于可能导致歧义：<code>\111</code>是代表第111个反向引用，还是第11个反向引用后加上数字1，还是第一个反向引用加上数字11？</p>
<p>perl会认为是第111个反向引用。</p>
<p>perl提供了一种消除歧义的方法是<code>\g&#123;N&#125;</code>来表示反向引用。</p>
<p>同时，引用的编号也可以为负数，相对反向引用，即基于当前位置向前计数得到的捕获模式：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"><span class="keyword">my</span> $str = <span class="string">&quot;abcabc&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> ($str =~ <span class="regexp">/(a)(b)(c)\g&#123;-3&#125;\g&#123;-2&#125;\g&#123;-1&#125;/</span>) &#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;Match found!\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="选择符"><a href="#选择符" class="headerlink" title="选择符 |"></a>选择符 <code>|</code></h3><p>竖线代表或操作，左右2边的字符串将会分别参与匹配。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span> ( <span class="string">qw(fred betty barney dino)</span> ) &#123;</span><br><span class="line"> <span class="keyword">if</span> ( <span class="regexp">/fred|barney/</span> ) &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;$_ matched\n&quot;</span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>由于竖线会把前后当作2个独立的字符串进行处理，因此有时需要配合括号使用：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$_ = <span class="string">&quot;Fred Rubble&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>( <span class="regexp">/Fred|Wilma Flintstone/</span> ) &#123; <span class="comment"># unexpectedly matches</span></span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;It matched!\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>改为：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$_ = <span class="string">&quot;Fred Rubble&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>( <span class="regexp">/(Fred|Wilma) Flintstone/</span> ) &#123; <span class="comment"># doesn&#x27;t match</span></span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;It matched!\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="字符集"><a href="#字符集" class="headerlink" title="字符集[]"></a>字符集<code>[]</code></h3><p>方括号中的单个字符会被逐一匹配。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$_ = <span class="string">&quot;Bamm-Bamm&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="regexp">/Bamm-?[Bb]amm/</span>) &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;The string has Bamm-Bamm\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>此外可以用<code>^</code>符号进行补集操作，可以匹配除了方括号中字符的其他所有字符。</p>
<p><img src="/2024/05/08/LearnPerl/image-63.png"></p>
<h3 id="字符集的简写"><a href="#字符集的简写" class="headerlink" title="字符集的简写"></a>字符集的简写</h3><p>对于一些高频出现的字符集，正则表达式为其设计了简写模式：</p>
<p><img src="/2024/05/08/LearnPerl/image-64.png"></p>
<h3 id="Unicode-特性"><a href="#Unicode-特性" class="headerlink" title="Unicode 特性"></a>Unicode 特性</h3><p>对于一些Unicode字符集，perl使用<code>\p&#123;&#125;</code>的方式进行描述，详见<br><a target="_blank" rel="noopener" href="https://perldoc.perl.org/perluniprops">https://perldoc.perl.org/perluniprops</a></p>
<h3 id="锚点Anchor"><a href="#锚点Anchor" class="headerlink" title="锚点Anchor"></a>锚点Anchor</h3><p><code>\A</code>用于强调必须从字符串开头进行匹配，<code>\z</code>强调必须匹配词尾。<br><code>\Z</code>强调除了必须匹配词尾以外，还可以加上一个空行符或不加。</p>
<h3 id="词锚-word-anchor"><a href="#词锚-word-anchor" class="headerlink" title="词锚 word anchor"></a>词锚 word anchor</h3><p><code>\b</code>用于锚定单词的词尾。例如</p>
<p><code>/\bfred\b/</code>可以匹配fred本身，而不会匹配Alfred 或fredstone。</p>
<p><code>\b</code>可以锚定所有<code>\w</code>可以表示的字符的结尾，即数字，字母和下划线。而<code>\B</code>锚定所有<code>\W</code>可以表示的字符的结尾，即上述内容的补集。</p>
<h3 id="习题-4"><a href="#习题-4" class="headerlink" title="习题"></a>习题</h3><p><img src="/2024/05/08/LearnPerl/image-65.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (&lt;&gt;)&#123;</span><br><span class="line">    <span class="keyword">chomp</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="regexp">/fred/</span>)&#123;</span><br><span class="line">        <span class="keyword">say</span> <span class="string">&quot;$_ match&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">say</span> <span class="string">&quot;$_ don&#x27;t match!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image-67.png"></p>
<p><img src="/2024/05/08/LearnPerl/image-66.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (&lt;&gt;)&#123;</span><br><span class="line">    <span class="keyword">chomp</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="regexp">/[Ff]red/</span>)&#123;</span><br><span class="line">        <span class="keyword">say</span> <span class="string">&quot;$_ match&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">say</span> <span class="string">&quot;$_ don&#x27;t match!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image-68.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (&lt;&gt;)&#123;</span><br><span class="line">    <span class="keyword">chomp</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="regexp">/\./</span>)&#123;</span><br><span class="line">        <span class="keyword">say</span> <span class="string">&quot;$_ match&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">say</span> <span class="string">&quot;$_ don&#x27;t match!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-69.png"></p>
<p><img src="/2024/05/08/LearnPerl/image-70.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (&lt;&gt;)&#123;</span><br><span class="line">    <span class="keyword">chomp</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="regexp">/\A[A-Z]+[a-z]+/</span>)&#123;</span><br><span class="line">        <span class="keyword">say</span> <span class="string">&quot;$_ match&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">say</span> <span class="string">&quot;$_ don&#x27;t match!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-71.png"></p>
<p><img src="/2024/05/08/LearnPerl/image-72.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (&lt;&gt;)&#123;</span><br><span class="line">    <span class="keyword">chomp</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="regexp">/(.+)\g&#123;-1&#125;/</span>)&#123;</span><br><span class="line">        <span class="keyword">say</span> <span class="string">&quot;$_ match&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">say</span> <span class="string">&quot;$_ don&#x27;t match!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-73.png"></p>
<p><img src="/2024/05/08/LearnPerl/image-74.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (&lt;&gt;)&#123;</span><br><span class="line">    <span class="keyword">chomp</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="regexp">/fred/</span>&amp;&amp;<span class="regexp">/wilma/</span>)&#123;</span><br><span class="line">        <span class="keyword">say</span> <span class="string">&quot;$_ match&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">say</span> <span class="string">&quot;$_ don&#x27;t match!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Ch8-正则表达式进行匹配"><a href="#Ch8-正则表达式进行匹配" class="headerlink" title="Ch8 正则表达式进行匹配"></a>Ch8 正则表达式进行匹配</h2><p>perl用m来进行匹配操作，之前的双斜杠<code>//</code>写法其实是匹配的简写。m像qw一样，可以搭配任意成对的括号使用。</p>
<p>例如<code>m(fred), m\&lt;fred&gt;, m&#123;fred&#125;, or m[fred]</code></p>
<h3 id="i进行大小写无关的匹配"><a href="#i进行大小写无关的匹配" class="headerlink" title="/i进行大小写无关的匹配"></a><code>/i</code>进行大小写无关的匹配</h3><p>当使用i进行修饰时，会忽略字符串的大小写区别。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">print</span> <span class="string">&quot;Would you like to play a game? &quot;</span>;</span><br><span class="line"><span class="keyword">chomp</span>($_ = &lt;STDIN&gt;);</span><br><span class="line"><span class="keyword">if</span> (<span class="regexp">/yes/i</span>) &#123; <span class="comment"># case-insensitive match</span></span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;In that case, I recommend that you go bowling.\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意修饰符是放在外面的，和被引用的正则表达式不再同一个括号里。因此同样可以写成：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;Would you like to play a game? &quot;</span>;</span><br><span class="line"><span class="keyword">chomp</span>($_ = &lt;STDIN&gt;);</span><br><span class="line"><span class="keyword">if</span> (<span class="regexp">m&#123;yes&#125;i</span>) &#123; <span class="comment"># case-insensitive match</span></span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;In that case, I recommend that you go bowling.\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="s进行任意字符的匹配"><a href="#s进行任意字符的匹配" class="headerlink" title="/s进行任意字符的匹配"></a><code>/s</code>进行任意字符的匹配</h3><p>由于<code>.*</code>可以匹配除了换行符以外的任意字符串，因此为了处理字符串中的换行符，可以用<code>s</code>进行修饰。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$_ = <span class="string">&quot;I saw Barney\ndown at the bowling alley\nwith Fred\nlast night.\n&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="regexp">/Barney.*Fred/s</span>) &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;That string mentions Fred after Barney!\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>\s</code>的修饰会让所有<code>.</code>变得能匹配换行符。如果想让表达式中的个别<code>.</code>保持对换行符的不匹配，可以换成<code>[^\n]</code>或<code>\N</code>。</p>
<h3 id="x加入空白符"><a href="#x加入空白符" class="headerlink" title="/x加入空白符"></a><code>/x</code>加入空白符</h3><p>使用<code>x</code>修饰可以使得表达式中的变量，使得其中的空白字符可以被忽略。这样做可以增加正则表达式的可读性。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/-?[<span class="number">0</span>-<span class="number">9</span>]+\.?[<span class="number">0</span>-<span class="number">9</span>]*<span class="regexp">/ # what is this doing?</span></span><br><span class="line"><span class="regexp">/</span> -? [<span class="number">0</span>-<span class="number">9</span>]+ \.? [<span class="number">0</span>-<span class="number">9</span>]* /<span class="keyword">x</span> <span class="comment"># a little better</span></span><br></pre></td></tr></table></figure>

<h3 id="修饰符号的组合"><a href="#修饰符号的组合" class="headerlink" title="修饰符号的组合"></a>修饰符号的组合</h3><p>可以将多个修饰符号组合使用，只需要将他们一起放在正则表达式的末尾：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="regexp">/barney.*fred/is</span>) &#123; <span class="comment"># both /i and /s</span></span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;That string mentions Fred after Barney!\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="regexp">m&#123;</span></span><br><span class="line"><span class="regexp"> barney # the little guy</span></span><br><span class="line"><span class="regexp"> .* # anything in between</span></span><br><span class="line"><span class="regexp"> fred # the loud guy</span></span><br><span class="line"><span class="regexp">&#125;six</span>) &#123; <span class="comment"># all three of /s and /i and /x</span></span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;That string mentions Fred after Barney!\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="选择一种字符的解释方式"><a href="#选择一种字符的解释方式" class="headerlink" title="选择一种字符的解释方式"></a>选择一种字符的解释方式</h3><p><code>/a</code>用于表示ascii,<code>/u</code>用于表示unicode，<code>/l</code>表示Local，会选择本地的字符集进行匹配。</p>
<h3 id="m进行行匹配"><a href="#m进行行匹配" class="headerlink" title="\m进行行匹配"></a><code>\m</code>进行行匹配</h3><p>使用<code>m</code>配合词首锚位<code>^</code>和词尾锚位<code>$</code>,可以实现对各行的匹配而非单整个字符串的匹配。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line">$_ = <span class="string">&#x27;This is a wilma line</span></span><br><span class="line"><span class="string">barney is on another line</span></span><br><span class="line"><span class="string">but this ends in fred</span></span><br><span class="line"><span class="string">and a final dino line&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="regexp">/fred$/m</span>)&#123;</span><br><span class="line">    <span class="keyword">say</span> <span class="string">&quot;match success!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>同样的，如果不想开启多行匹配，最好还是使用<code>\A</code>和<code>\Z</code>。</p>
<h3 id="其他操作"><a href="#其他操作" class="headerlink" title="其他操作"></a>其他操作</h3><h4 id="绑定操作符"><a href="#绑定操作符" class="headerlink" title="绑定操作符 =~"></a>绑定操作符 <code>=~</code></h4><p>绑定操作符 <code>=~</code>会高速perl用右边的正则表达式来匹配左边的字符串。例如：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">my</span> $some_other = <span class="string">&quot;I dream of betty rubble.&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> ($some_other =~ <span class="regexp">/\brub/</span>) &#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;Aye, there&#x27;s the rub.\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="捕获变量"><a href="#捕获变量" class="headerlink" title="捕获变量"></a>捕获变量</h4><p>perl 用<code>$1</code>,<code>$2</code>这样的变量来描述正则表达式捕获的变量。每个括号捕获到的事物会被像这样编号。注意捕获变量和反向引用的区别：</p>
<p><img src="/2024/05/08/LearnPerl/image-75.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$_ = <span class="string">&quot;Hello there, neighbor&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="regexp">/\s([a-zA-Z]+),/</span>) &#123; <span class="comment"># capture the word between space and comma</span></span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;the word was $1\n&quot;</span>; <span class="comment"># the word was there</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$_ = <span class="string">&quot;Hello there, neighbor&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="regexp">/(\S+) (\S+), (\S+)/</span>) &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;words were $1 $2 $3\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image-76.png"></p>
<p>被捕获的字符串也可以为空字符串，注意空字符串和undef是不同的。</p>
<h4 id="捕获变量的存续期"><a href="#捕获变量的存续期" class="headerlink" title="捕获变量的存续期"></a>捕获变量的存续期</h4><p>当一个新的匹配发生时，捕获变量会覆盖之前捕获的值，而未发生捕获时，上一个值将一直存在。</p>
<h4 id="不捕获圆括号"><a href="#不捕获圆括号" class="headerlink" title="不捕获圆括号 (?:)"></a>不捕获圆括号 <code>(?:)</code></h4><p>在左括号前面加上问号和冒号，可以让圆括号只用来分组而不用来捕获。</p>
<p>例如：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="regexp">/(bronto)?saurus (steak|burger)/</span>) &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;Fred wants a $2\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>前面的bronto不管有没有，都会占用捕获变量$1的位置，而加上相应的不捕获符号后，可以忽略第一个括号的内容：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="regexp">/(?:bronto)?saurus (steak|burger)/</span>) &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;Fred wants a $1\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="命名捕获"><a href="#命名捕获" class="headerlink" title="命名捕获"></a>命名捕获</h4><p>如果有需要修改正则表达式的情况，添加一个括号有可能使整个正则表达式乱套，出来提供不捕获标记<code>?:</code>的写法之外，perl还支持对捕获变量之间命名，方便记忆。</p>
<p>使用<code> (?&lt;LABEL&gt;PATTERN)</code>的写法来为捕获变量命名</p>
<p>之后就可以使用<code>$+&#123;name1&#125;</code>和<code>$+&#123;name2&#125;</code>的形式来引用这些捕获的变量。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"> <span class="keyword">my</span> $names = <span class="string">&#x27;Fred or Barney&#x27;</span>;</span><br><span class="line"> <span class="keyword">if</span> ( $names =~ <span class="regexp">m/((?&lt;name2&gt;\w+) (and|or) (?&lt;name1&gt;\w+))/</span> ) &#123;</span><br><span class="line">  <span class="keyword">say</span> <span class="string">&quot;I saw $+&#123;name1&#125; and $+&#123;name2&#125;&quot;</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>捕获之后，可是使用<code>\g&#123;label&#125;</code>和<code>\k&lt;label&gt;</code>这样的写法来对其进行反向引用。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"><span class="keyword">my</span> $names = <span class="string">&#x27;Fred Flintstone and Wilma Flintstone&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> ( $names =~ <span class="regexp">m/(?&lt;last_name&gt;\w+) and \w+ \k&lt;last_name&gt;/</span> ) &#123;</span><br><span class="line"> <span class="keyword">say</span> <span class="string">&quot;I saw $+&#123;last_name&#125;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="自动捕获变量"><a href="#自动捕获变量" class="headerlink" title="自动捕获变量"></a>自动捕获变量</h4><p>5.10版本以后，perl用<code>$&#123;^PREMATCH&#125;,  $&#123;^MATCH&#125;, $&#123;^POSTMATCH&#125;</code>这三个变量来表示正则表达式中的自动捕获变量。</p>
 <figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"> <span class="keyword">if</span> (<span class="string">&quot;Hello there, neighbor&quot;</span> =~ <span class="regexp">/\s(\w+),/p</span>) &#123;</span><br><span class="line">  <span class="keyword">print</span> <span class="string">&quot;That actually matched &#x27;<span class="subst">$&#123;^MATCH&#125;</span>&#x27;.\n&quot;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">if</span> (<span class="string">&quot;Hello there, neighbor&quot;</span> =~ <span class="regexp">/\s(\w+),/p</span>) &#123;</span><br><span class="line">  <span class="keyword">print</span> <span class="string">&quot;That was (<span class="subst">$&#123;^PREMATCH&#125;</span>)(<span class="subst">$&#123;^MATCH&#125;</span>)(<span class="subst">$&#123;^POSTMATCH&#125;</span>).\n&quot;</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p> <img src="/2024/05/08/LearnPerl/image-77.png"></p>
<h4 id="优先级"><a href="#优先级" class="headerlink" title="优先级"></a>优先级</h4><p>各类匹配变量的优先级如下表：</p>
<p><img src="/2024/05/08/LearnPerl/image-78.png"></p>
<h4 id="测试程序"><a href="#测试程序" class="headerlink" title="测试程序"></a>测试程序</h4><p>一个简单的测试正则表达式匹配结果的程序：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (&lt;&gt;) &#123;           <span class="comment"># take one input line at a time</span></span><br><span class="line"> <span class="keyword">chomp</span>;</span><br><span class="line"> <span class="keyword">if</span> (<span class="regexp">/YOUR_PATTERN_GOES_HERE/</span>) &#123;</span><br><span class="line">   <span class="keyword">print</span> <span class="string">&quot;Matched: |$`&lt;$&amp;&gt;$&#x27;|\n&quot;</span>;  <span class="comment"># the special match vars</span></span><br><span class="line"> &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">   <span class="keyword">print</span> <span class="string">&quot;No match: |$_|\n&quot;</span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="习题-5"><a href="#习题-5" class="headerlink" title="习题"></a>习题</h3><p><img src="/2024/05/08/LearnPerl/image-79.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (&lt;&gt;) &#123;           <span class="comment"># take one input line at a time</span></span><br><span class="line">  <span class="keyword">chomp</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="regexp">/match/</span>) &#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;Matched: |$`&lt;$&amp;&gt;$&#x27;|\n&quot;</span>;  <span class="comment"># the special match vars</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;No match: |$_|\n&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-80.png"></p>
<p><img src="/2024/05/08/LearnPerl/image-81.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (&lt;&gt;) &#123;           <span class="comment"># take one input line at a time</span></span><br><span class="line">  <span class="keyword">chomp</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="regexp">/\w*a\s/</span>) &#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;Matched: |$`&lt;$&amp;&gt;$&#x27;|\n&quot;</span>;  <span class="comment"># the special match vars</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;No match: |$_|\n&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image-82.png"></p>
<p><img src="/2024/05/08/LearnPerl/image-83.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (&lt;&gt;) &#123;           <span class="comment"># take one input line at a time</span></span><br><span class="line">  <span class="keyword">chomp</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="regexp">/(\w*a)\s/</span>) &#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;\$1 contains  $1\n&quot;</span>;  <span class="comment"># the special match vars</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;No match: |$_|\n&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-84.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (&lt;&gt;) &#123;           <span class="comment"># take one input line at a time</span></span><br><span class="line">  <span class="keyword">chomp</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="regexp">/(?&lt;words&gt;\w*a)\s/</span>) &#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;&#x27;words&#x27; contains  $+&#123;words&#125;\n&quot;</span>;  <span class="comment"># the special match vars</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;No match: |$_|\n&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-85.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (&lt;&gt;) &#123;           <span class="comment"># take one input line at a time</span></span><br><span class="line">  <span class="keyword">chomp</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="regexp">/(?&lt;words&gt;\w*a)(?&lt;appends&gt;(\W|\s)\w&#123;0,4&#125;)/</span>) &#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;&#x27;words&#x27; contains  $+&#123;words&#125;, followed by $+&#123;appends&#125;\n&quot;</span>;  <span class="comment"># the special match vars</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;No match: |$_|\n&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-86.png"></p>
<p><img src="/2024/05/08/LearnPerl/image-87.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (&lt;&gt;) &#123;           <span class="comment"># take one input line at a time</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="regexp">/([ \t]$)/</span>) &#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;$_ match...\n&quot;</span>;  <span class="comment"># the special match vars</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;No match: $_\n&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<h2 id="Ch9-用正则表达式处理文件"><a href="#Ch9-用正则表达式处理文件" class="headerlink" title="Ch9 用正则表达式处理文件"></a>Ch9 用正则表达式处理文件</h2><h3 id="用s-进行替换"><a href="#用s-进行替换" class="headerlink" title="用s///进行替换"></a>用<code>s///</code>进行替换</h3><p>如果把<code>m//</code>看作是单纯的查找操作，那么<code>s///</code>则是匹配后替换的操作。前面是要匹配的表达式，后面是需要替换的表达式。</p>
<p>如：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"> $_ = <span class="string">&quot;He&#x27;s out bowling with Barney tonight.&quot;</span>;</span><br><span class="line"> <span class="regexp">s/Barney/Fred/</span>;  <span class="comment"># Replace Barney with Fred</span></span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;$_\n&quot;</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image-88.png"></p>
<p>另外，如果匹配失败，则什么都不会发生。</p>
<p>表达式本身具有返回值，如果替换成功会返回true:</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$_ = <span class="string">&quot;fred flintstone&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="regexp">s/fred/wilma/</span>) &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;Successfully replaced fred with wilma!\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="使用g进行全局替换"><a href="#使用g进行全局替换" class="headerlink" title="使用g进行全局替换"></a>使用<code>g</code>进行全局替换</h3><p>s模式默认只替换匹配到的第一个模式。想要进行全局替换，需要用到<code>g</code>,即global模式：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$_ = <span class="string">&quot;home, sweet home!&quot;</span>;</span><br><span class="line"><span class="regexp">s/home/cave/g</span>;</span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;$_\n&quot;</span>;  <span class="comment"># &quot;cave, sweet cave!&quot;</span></span><br></pre></td></tr></table></figure>

<p>g模式会进行全局的，不充分的替换。</p>
<p>一个常用的场景是去除字符串中多余的空格：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$_ = <span class="string">&quot;Input  data\t may have    extra whitespace.&quot;</span>;</span><br><span class="line"><span class="regexp">s/\s+/ /g</span>;  <span class="comment"># Now it says &quot;Input data may have extra whitespace.&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="使用不同的界定符"><a href="#使用不同的界定符" class="headerlink" title="使用不同的界定符"></a>使用不同的界定符</h3><p>就像qw可以使用不同的界定符一样，匹配和替换也可以使用不同符号。区别在于，成对的符号必须左右匹配，而相同的界定符只需要出现3个：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">s<span class="comment">#\Ahttps://#http://#;</span></span><br><span class="line">...</span><br><span class="line"> s<span class="string">&#123;fred&#125;</span><span class="string">&#123;barney&#125;</span>;</span><br><span class="line"> s[fred](barney);</span><br><span class="line"> s&lt;fred&gt;<span class="comment">#barney#;</span></span><br></pre></td></tr></table></figure>

<h3 id="替换修饰符"><a href="#替换修饰符" class="headerlink" title="替换修饰符"></a>替换修饰符</h3><p>在替换时可以添加<code>/i, /x, m/, /s</code>等修饰符，进行匹配修饰。</p>
<p>例如：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s<span class="comment">#wilma#Wilma#gi;  # replace every WiLmA or WILMA with Wilma</span></span><br><span class="line">s&#123;__END_<span class="number">_</span>.*&#125;&#123;&#125;s;   <span class="comment"># chop off the end marker and all following lines</span></span><br></pre></td></tr></table></figure>

<h3 id="绑定操作符-1"><a href="#绑定操作符-1" class="headerlink" title="绑定操作符"></a>绑定操作符</h3><p>用法与m时一样，可以针对变量使用：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$file_name =~ s<span class="comment">#\A.*/##s; </span></span><br></pre></td></tr></table></figure>

<p>如果表示一个变量不能匹配一个正则表达式，使用符号<code>!~</code>。</p>
<h3 id="无损替换"><a href="#无损替换" class="headerlink" title="无损替换"></a>无损替换</h3><p>如果想保留替换前的字符串，可以先复制一份：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">my</span> $original = <span class="string">&#x27;Fred ate 1 rib&#x27;</span>;</span><br><span class="line"><span class="keyword">my</span> $copy = $original;</span><br><span class="line">$copy =~ <span class="regexp">s/\d+ ribs?/10 ribs/</span>;</span><br></pre></td></tr></table></figure>

<p>等价于：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">my</span> $copy = $original) =~ <span class="regexp">s/\d+ ribs?/10 ribs/</span>;</span><br></pre></td></tr></table></figure>

<p>5.14以后的版本，可以加上一个<code>/r</code>修饰符，这样会将原字符串保持不变，而将替换结果返回：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> $original = <span class="string">&#x27;Fred ate 1 rib&#x27;</span>;</span><br><span class="line"><span class="keyword">my</span> $copy = $original =~ <span class="regexp">s/\d+ ribs?/10 ribs/r</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;original:$original&quot;</span>;</span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;copy:$copy&quot;</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image-89.png"></p>
<h3 id="大小写转换"><a href="#大小写转换" class="headerlink" title="大小写转换"></a>大小写转换</h3><p><code>\U</code> 可以将其后的所有小写字母替换为大写。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line">$_ = <span class="string">&quot;I saw Barney with Fred.&quot;</span>;</span><br><span class="line"><span class="regexp">s/(fred|barney)/\U$1/gi</span>;  <span class="comment"># $_ is now &quot;I saw BARNEY with FRED.&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> $_;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image-90.png"></p>
<p><code>\L</code>可以将其后的所有字母转换为小写。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s/(fred|barney)/\L$1/gi;  <span class="comment"># $_ is now &quot;I saw barney with fred.&quot;</span></span><br></pre></td></tr></table></figure>

<p>同时，可以使用<code>\E</code>关闭后续的大小写转换：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s/(\w+) with (\w+)/\U$2\E with $1/i;  <span class="comment"># $_ is now &quot;I saw FRED with barney.&quot;</span></span><br></pre></td></tr></table></figure>

<p>当使用<code>\l</code>和<code>\u</code>时，只会作用于一个字母：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s/(fred|barney)/\u$1/ig;  <span class="comment"># $_ is now &quot;I saw FRED with Barney.&quot;</span></span><br></pre></td></tr></table></figure>
<p>连续使用<code>\u</code>,<code>\L</code>,可以实现首字母大写，后续字母小写：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s/(fred|barney)/\u\L$1/ig;  <span class="comment"># $_ is now &quot;I saw Fred with Barney.&quot;</span></span><br></pre></td></tr></table></figure>

<p>这里的大小写转换可以用在任何双引号定义的字符串中：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">print</span> <span class="string">&quot;Hello, \L\u$name\E, would you like to play a game?\n&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>大小写转换被封装为了不同的函数：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">my</span> $start   = <span class="string">&quot;Fred&quot;</span>;</span><br><span class="line"><span class="keyword">my</span> $uncapp  = <span class="keyword">lc</span>( $start );         <span class="comment"># fred,用于将字符串中的所有字符转换为小写。它的全称是 &quot;lowercase&quot;。</span></span><br><span class="line"><span class="keyword">my</span> $uppered = <span class="keyword">uc</span>( $uncapp );        <span class="comment"># FRED,用于将字符串中的所有字符转换为大写。它的全称是 &quot;uppercase&quot;。</span></span><br><span class="line"><span class="keyword">my</span> $lowered = <span class="keyword">lc</span>( $uppered );       <span class="comment"># fred</span></span><br><span class="line"><span class="keyword">my</span> $capped  = <span class="keyword">ucfirst</span>( $lowered );  <span class="comment"># Fred,首字母大写</span></span><br><span class="line"><span class="keyword">my</span> $folded  = fc( $uncapped );      <span class="comment"># fred,fc 函数用于将字符串转换为规范化的小写形式。它的全称是 &quot;foldcase&quot;，主要用于 Unicode 字符串的大小写折叠（大小写无关比较）。</span></span><br></pre></td></tr></table></figure>

<h3 id="元引用"><a href="#元引用" class="headerlink" title="元引用"></a>元引用</h3><p>可以使用<code>\Q</code>使其后面的所有括号都代表其原始字符：<br>例如如果想去掉字符串中多余的括号：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( <span class="regexp">s/\(\(\(Fred/Fred/</span> ) &#123;    <span class="comment"># Compiles, but messy!</span></span><br><span class="line">  <span class="keyword">print</span> <span class="string">&quot;Replaced name\n&quot;</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>这样写需要多个反引号，显得十分混乱，可以使用<code>\Q</code>进行元引用：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( <span class="regexp">s/\Q(((Fred/Fred/</span> ) &#123;     <span class="comment"># Less messy</span></span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;Replaced name\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="split操作"><a href="#split操作" class="headerlink" title="split操作"></a>split操作</h3><p>split可以根据特定的符号对字符串进行拆分：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> @fields = <span class="keyword">split</span> <span class="regexp">/:/</span>, <span class="string">&quot;abc:def:g:h&quot;</span>; </span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> <span class="keyword">my</span> $temp(@fields)&#123;</span><br><span class="line">    <span class="keyword">say</span> $temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-91.png"></p>
<p>分隔符中间没有其他字符则被转换为空字符，perl会保留列表开头的空字符，而省略结尾的空字符：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">my</span> @fields = <span class="keyword">split</span> <span class="regexp">/:/</span>, <span class="string">&quot;:::a:b:c:::&quot;</span>;  <span class="comment"># gives (&quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;a&quot;, &quot;b&quot;, &quot;c&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> @fields = <span class="keyword">split</span> <span class="regexp">/:/</span>, <span class="string">&quot;:::a:b:c:::&quot;</span>;  <span class="comment"># gives (&quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;a&quot;, &quot;b&quot;, &quot;c&quot;)</span></span><br></pre></td></tr></table></figure>

<p>想要保留末尾的空字符，需要再增加一个参数-1:</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">my</span> @fields = <span class="keyword">split</span> <span class="regexp">/:/</span>, <span class="string">&quot;:::a:b:c:::&quot;</span>, -<span class="number">1</span>;  <span class="comment"># gives </span></span><br><span class="line">(<span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>一个常见的用法是分割句子中的每个单词：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">my</span> $some_input = <span class="string">&quot;This  is a \t        test.\n&quot;</span>;</span><br><span class="line"><span class="keyword">my</span> @args = <span class="keyword">split</span> <span class="regexp">/\s+/</span>, $some_input;  <span class="comment"># (&quot;This&quot;, &quot;is&quot;, &quot;a&quot;, &quot;test.&quot;)</span></span><br></pre></td></tr></table></figure>

<p>split会默认使用空格分割<code>$_</code>变量中的字符串：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">my</span> @fields = <span class="keyword">split</span>;  <span class="comment"># like split /\s+/, $_;</span></span><br></pre></td></tr></table></figure>

<h3 id="join操作"><a href="#join操作" class="headerlink" title="join操作"></a>join操作</h3><p>join完成的操作和split相反，将分开的字符串通过符号连接起来：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">my</span> $result = <span class="keyword">join</span> $glue, @pieces;</span><br></pre></td></tr></table></figure>

<p>join可看作是胶水操作，第一个参数是具体的连接参数，第二个之后的参数是需要连接的对象。如果第二个参数是一个标量，则只返回第二个变量，而不需要胶水：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">my</span> $y = <span class="keyword">join</span> <span class="string">&quot;foo&quot;</span>, <span class="string">&quot;bar&quot;</span>;       <span class="comment"># gives just &quot;bar&quot;, since no foo glue is needed</span></span><br><span class="line"><span class="keyword">my</span> @empty;                       <span class="comment"># empty array</span></span><br><span class="line"><span class="keyword">my</span> $empty = <span class="keyword">join</span> <span class="string">&quot;baz&quot;</span>, @empty;  <span class="comment"># no items, so it&#x27;s an empty string</span></span><br></pre></td></tr></table></figure>

<h3 id="列表上下文中的匹配"><a href="#列表上下文中的匹配" class="headerlink" title="列表上下文中的匹配"></a>列表上下文中的匹配</h3><p>在列表上下文中使用m进行匹配时，如果匹配成功，返回的是所有匹配变量的列表，否则返回空列表。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> $text = <span class="string">&quot;Fred dropped a 5 ton granite block on Mr. Slate&quot;</span>;</span><br><span class="line"> <span class="keyword">my</span> @words = ($text =~ <span class="regexp">/([a-z]+)/ig</span>);</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;Result: @words\n&quot;</span>;</span><br><span class="line"> <span class="comment"># Result: Fred dropped a ton granite block on Mr Slate</span></span><br></pre></td></tr></table></figure>

<p>如果匹配标量中包含2个及以上的可捕获变量时，可以将其转换为一个哈希表：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">my</span> $text = <span class="string">&quot;Barney Rubble Fred Flintstone Wilma Flintstone&quot;</span>;</span><br><span class="line"> <span class="keyword">my</span> %last_name = ($text =~ <span class="regexp">/(\w+)\s+(\w+)/g</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> <span class="keyword">my</span> $keys ( <span class="keyword">keys</span> %last_name) &#123; <span class="comment"># each patron, in order</span></span><br><span class="line"> <span class="keyword">if</span> ($last_name&#123;$keys&#125;) &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;$keys =&gt; $last_name&#123;$keys&#125;\n&quot;</span>; <span class="comment"># fred has 3 items</span></span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-92.png"></p>
<p>第一个变量被当作键，第二个当作值，如果有第三个捕获变量，将会被忽略。</p>
<h3 id="更强大的正则表达式"><a href="#更强大的正则表达式" class="headerlink" title="更强大的正则表达式"></a>更强大的正则表达式</h3><h4 id="非贪婪量词"><a href="#非贪婪量词" class="headerlink" title="非贪婪量词"></a>非贪婪量词</h4><p>一般情况下，正则表达式遵循贪婪匹配规则，也就是说会尽可能匹配多的字符，为量词加上<code>?</code>,可以改为非贪婪模式，匹配尽可能少的字符：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">my</span> $text = <span class="string">&#x27;&lt;b&gt;Fred&lt;/b&gt; and &lt;b&gt;Barney&lt;/b&gt;&#x27;</span>;</span><br><span class="line"> <span class="keyword">my</span> $match_count = $text =~ s|&lt;b&gt;(.*)&lt;<span class="regexp">/b&gt;|\U$1|g;</span></span><br><span class="line"><span class="regexp"> print &quot;$match_count: $text\n&quot;;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"> my $text = &#x27;&lt;b&gt;Fred&lt;/</span>b&gt; <span class="keyword">and</span> &lt;b&gt;Barney&lt;<span class="regexp">/b&gt;&#x27;;</span></span><br><span class="line"><span class="regexp"> my $match_count = $text =~ s|&lt;b&gt;(.*?)&lt;/</span>b&gt;|\U$1|g; <span class="comment"># nongreedy</span></span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;$match_count: $text\n&quot;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image-93.png"> </p>
<p>上述第一种情况，由于是贪婪匹配，只捕获到了最长的一个子字符，并将其中的所有字母设置为大写。</p>
<p>第二种情况下，<code>.*?</code>改变为非贪婪匹配，得到我们想要的结果。</p>
<p>非贪婪描述符对不同量词的作用效果如下表所示：</p>
<p><img src="/2024/05/08/LearnPerl/image-94.png"></p>
<h4 id="更好的单词边界"><a href="#更好的单词边界" class="headerlink" title="更好的单词边界"></a>更好的单词边界</h4><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> $string = <span class="string">&quot;This doesn&#x27;t capitalize correctly.&quot;</span>;</span><br><span class="line">$string =~ <span class="regexp">s/\b(\w)/\U$1/g</span>;</span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;$string\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> $string = <span class="string">&quot;this doesn&#x27;t capitalize correctly.&quot;</span>;</span><br><span class="line">$string =~ <span class="regexp">s/\b&#123;wb&#125;(\w)/\U$1/g</span>;</span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;$string\n&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-95.png"></p>
<p>理论上\b(\w)可以匹配一个单词的开头，但是Perl会把’也匹配到，导致奇怪的效果，使用\b{wb}则可以正确匹配。</p>
<p>类似还有<code> \b&#123;sb&#125;</code>和<code> \b&#123;lb&#125;</code>等。</p>
<h4 id="处理多行文本"><a href="#处理多行文本" class="headerlink" title="处理多行文本"></a>处理多行文本</h4><p>Perl可以一次读入文本的多行，将换行当作<code>\n</code>处理。使用<code>^</code>可以匹配行首：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line">$_ = <span class="string">&quot;I&#x27;m much better\nthan Barney is\nat bowling,\nWilma.\n&quot;</span>;</span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;Found &#x27;wilma&#x27; at start of line\n&quot;</span> <span class="keyword">if</span> /^wilma\b/im;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-96.png"></p>
<p>例如下面的文件在每一行加入文件名信息：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> $filename = <span class="keyword">pop</span> @ARGV;</span><br><span class="line"><span class="keyword">open</span> FILE, $filename</span><br><span class="line">  <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">&quot;Can&#x27;t open &#x27;$filename&#x27;: $!&quot;</span>;</span><br><span class="line"><span class="keyword">my</span> $lines = <span class="keyword">join</span> <span class="string">&#x27;&#x27;</span>, &lt;FILE&gt;;</span><br><span class="line">$lines =~ <span class="regexp">s/^/$filename: /gm</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> $lines;</span><br><span class="line"><span class="keyword">close</span> $filename;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-97.png"></p>
<h4 id="一次更新多个文件"><a href="#一次更新多个文件" class="headerlink" title="一次更新多个文件"></a>一次更新多个文件</h4><p>使用如下程序一次更新多个程序：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl -w</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> strict;</span><br><span class="line"></span><br><span class="line"><span class="keyword">chomp</span>(<span class="keyword">my</span> $date = <span class="string">`date`</span>);</span><br><span class="line">$^I = <span class="string">&quot;.bak&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (&lt;&gt;) &#123;</span><br><span class="line">   <span class="regexp">s/\AAuthor:.*/Author: Randal L. Schwartz/</span>;</span><br><span class="line">   <span class="regexp">s/\APhone:.*\n//</span>;</span><br><span class="line">   <span class="regexp">s/\ADate:.*/Date: $date/</span>;</span><br><span class="line">   <span class="keyword">print</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-98.png"></p>
<p>如果把<code>$^I</code>设置为空字符，则不会留下任何备份。<br>(注意空字符不是undef)</p>
<h4 id="通过命令行直接编辑"><a href="#通过命令行直接编辑" class="headerlink" title="通过命令行直接编辑"></a>通过命令行直接编辑</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">perl -p -i.bak -w -e <span class="string">&#x27;s/Randall/Randal/g&#x27;</span> fred*.dat</span></span><br></pre></td></tr></table></figure>

<p>-p选项代表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">while (&lt;&gt;) &#123;</span><br><span class="line">  print;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>-i.bak 表示把<code>$^I</code>设置为.bak, -w表示打开warning，-e代表其后面跟着的是可执行代码，即’s&#x2F;Randall&#x2F;Randal&#x2F;g’，后面的fred*.dat是输入变量列表。</p>
<h3 id="课后习题"><a href="#课后习题" class="headerlink" title="课后习题"></a>课后习题</h3><p><img src="/2024/05/08/LearnPerl/image-99.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> $what=<span class="string">&quot;fred|barney&quot;</span>;</span><br><span class="line"><span class="keyword">while</span> (&lt;&gt;)&#123;</span><br><span class="line">    <span class="keyword">chomp</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="regexp">m/($what)&#123;3&#125;/</span> )&#123;</span><br><span class="line">    <span class="keyword">say</span> <span class="string">&quot;$_ matches $what!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-100.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"></span><br><span class="line">$^I = <span class="string">&quot;.out&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (&lt;&gt;)&#123;</span><br><span class="line">    <span class="regexp">s/fred/larry/ig</span>;</span><br><span class="line">    <span class="keyword">print</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-101.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"></span><br><span class="line">$^I = <span class="string">&quot;.out&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (&lt;&gt;)&#123;</span><br><span class="line">    <span class="regexp">s/fred/FRED_TEMP/ig</span>;</span><br><span class="line">    <span class="regexp">s/wilma/Fred/ig</span>;</span><br><span class="line">    <span class="regexp">s/FRED_TEMP/Wilma/g</span>;</span><br><span class="line">    <span class="keyword">print</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-102.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"></span><br><span class="line">$^I = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (&lt;&gt;)&#123;</span><br><span class="line">    <span class="keyword">print</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="regexp">m/(?&lt;shellbang&gt;#!.*\n)/</span>)&#123;</span><br><span class="line">        <span class="keyword">print</span>  <span class="string">&quot;## Copyright (C) 2024 by Wenkai&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-103.png"></p>
<p>答案是用了一个哈希表检查对应的文件有没有被处理过，感觉不是很靠谱。<br>还是应该逐行检查有没有版权声明才对。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> $filename = <span class="keyword">pop</span> @ARGV;</span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;file: $filename&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">open</span> FILE, $filename</span><br><span class="line">  <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">&quot;Can&#x27;t open &#x27;$filename&#x27;: $!&quot;</span>;</span><br><span class="line"><span class="keyword">my</span> $lines = <span class="keyword">join</span> <span class="string">&#x27;&#x27;</span>, &lt;FILE&gt;;</span><br><span class="line"><span class="keyword">close</span> FILE;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ($lines !~ <span class="regexp">/^## Copyright/m</span>)&#123;</span><br><span class="line">    <span class="keyword">say</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">    $lines =~ <span class="regexp">s/^(#!.*\n)/$1## Copyright (C) 2024 by Wenkai/</span>;</span><br><span class="line">    <span class="keyword">open</span> FILE, <span class="string">&#x27;&gt;&#x27;</span>, $filename <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">&quot;Cannot write to $filename: $!&quot;</span>;</span><br><span class="line">        <span class="keyword">print</span>  FILE  $lines;</span><br><span class="line">    <span class="keyword">close</span> FILE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Ch10-其他控制结构"><a href="#Ch10-其他控制结构" class="headerlink" title="Ch10 其他控制结构"></a>Ch10 其他控制结构</h2><h3 id="unless"><a href="#unless" class="headerlink" title="unless"></a>unless</h3><p>unless &#x3D; if not,当括号中的条件为假时，执行相应的操作。</p>
<p>unless可以跟着else语句，相当于if反过来。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unless</span> ($mon =~ <span class="regexp">/\AFeb/</span>) &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;This month has at least thirty days.\n&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;Do you see what&#x27;s going on here?\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>d</p>
<p>等价于：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ($mon =~ <span class="regexp">/\AFeb/</span>) &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;Do you see what&#x27;s going on here?\n&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;This month has at least thirty days.\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="until结构"><a href="#until结构" class="headerlink" title="until结构"></a>until结构</h3><p>当until中的条件为真时，结束循环，相当于while not。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">until</span> ($j &gt; $i) &#123;</span><br><span class="line"> $j *= <span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="表达式修饰符"><a href="#表达式修饰符" class="headerlink" title="表达式修饰符"></a>表达式修饰符</h3><p>可以在一个表达式后面跟上一个修饰符，当该修饰符成立时，表达式才被执行：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">print</span> <span class="string">&quot;$n is a negative number.\n&quot;</span> <span class="keyword">if</span> $n &lt; <span class="number">0</span>;</span><br></pre></td></tr></table></figure>
<p>相当于：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ($n &lt; <span class="number">0</span>) &#123;</span><br><span class="line">  <span class="keyword">print</span> <span class="string">&quot;$n is a negative number.\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>类似的操作还有：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&amp;error(<span class="string">&quot;Invalid input&quot;</span>) <span class="keyword">unless</span> &amp;valid($input);</span><br><span class="line">$i *= <span class="number">2</span> <span class="keyword">until</span> $i &gt; $j;</span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot; &quot;</span>, ($n += <span class="number">2</span>) <span class="keyword">while</span> $n &lt; <span class="number">10</span>;</span><br><span class="line">&amp;greet($_) <span class="keyword">foreach</span> @person;</span><br></pre></td></tr></table></figure>


<h3 id="裸块控制结构"><a href="#裸块控制结构" class="headerlink" title="裸块控制结构"></a>裸块控制结构</h3><p>一个没有关键字和条件表达式的结构称为裸块：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    body;</span><br><span class="line">  body;</span><br><span class="line">  body;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>裸块适用于一些一次性代码，其中的变量会被定义为局部变量。</p>
<h3 id="if-elsif结构"><a href="#if-elsif结构" class="headerlink" title="if elsif结构"></a>if elsif结构</h3><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( ! <span class="keyword">defined</span> $dino) &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;The value is undef.\n&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">elsif</span> ($dino =~ <span class="regexp">/^-?\d+\.?$/</span>) &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;The value is an integer.\n&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">elsif</span> ($dino =~ <span class="regexp">/^-?\d*\.\d+$/</span>) &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;The value is a _simple_ floating-point number.\n&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">elsif</span> ($dino eq <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;The value is the empty string.\n&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;The value is the string &#x27;$dino&#x27;.\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个不多解释了。</p>
<h3 id="自增与自减"><a href="#自增与自减" class="headerlink" title="自增与自减"></a>自增与自减</h3><p>与C语言相同的<code>++</code>和<code>--</code>操作</p>
<h3 id="for-循环"><a href="#for-循环" class="headerlink" title="for 循环"></a>for 循环</h3><p>与C语言相同的for循环格式。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ($i = –<span class="number">150</span>; $i &lt;= <span class="number">1000</span>; $i += <span class="number">3</span>) &#123;</span><br><span class="line">  <span class="keyword">print</span> <span class="string">&quot;$i\n&quot;</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<h3 id="for-与foreach的关系"><a href="#for-与foreach的关系" class="headerlink" title="for 与foreach的关系"></a>for 与foreach的关系</h3><p>在perl中，这俩其实是等价的。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="number">1</span>..<span class="number">10</span>) &#123;  <span class="comment"># really a foreach loop from 1 to 10</span></span><br><span class="line">  <span class="keyword">print</span> <span class="string">&quot;I can count to $_!\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="循环控制"><a href="#循环控制" class="headerlink" title="循环控制"></a>循环控制</h3><h4 id="last操作"><a href="#last操作" class="headerlink" title="last操作"></a>last操作</h4><p>相当于C中的break</p>
<h4 id="next操作"><a href="#next操作" class="headerlink" title="next操作"></a>next操作</h4><p>相当于C中的continue</p>
<h4 id="redo操作"><a href="#redo操作" class="headerlink" title="redo操作"></a>redo操作</h4><p>重复执行当前循环中的操作。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">22</span>;</span><br><span class="line"></span><br><span class="line"> <span class="comment"># Typing test</span></span><br><span class="line"> <span class="keyword">my</span> @words = <span class="string">qw&#123; fred barney pebbles dino wilma betty &#125;</span>;</span><br><span class="line"> <span class="keyword">my</span> $errors = <span class="number">0</span>;</span><br><span class="line"> <span class="keyword">foreach</span> (@words) &#123;</span><br><span class="line">  <span class="comment">## redo comes here ##</span></span><br><span class="line">  <span class="keyword">print</span> <span class="string">&quot;Type the word &#x27;$_&#x27;: &quot;</span>;</span><br><span class="line">  <span class="keyword">chomp</span>(<span class="keyword">my</span> $try = &lt;STDIN&gt;);</span><br><span class="line">   <span class="keyword">if</span> ($try <span class="keyword">ne</span> $_) &#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;Sorry - That&#x27;s not right.\n\n&quot;</span>;</span><br><span class="line">    $errors++;</span><br><span class="line">    <span class="keyword">redo</span>;  <span class="comment"># jump back up to the top of the loop</span></span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;You&#x27;ve completed the test, with $errors errors.\n&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-104.png"></p>
<p>redo, last 和next都可以在循环中嵌套使用，并且用于跳出或回到最内层循环。</p>
<h4 id="带标签的块"><a href="#带标签的块" class="headerlink" title="带标签的块"></a>带标签的块</h4><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">LINE: <span class="keyword">while</span> (&lt;&gt;) &#123;</span><br><span class="line">  WORD: <span class="keyword">foreach</span> (<span class="keyword">split</span>) &#123;</span><br><span class="line">    <span class="keyword">last</span> LINE <span class="keyword">if</span> /__END_<span class="number">_</span>/;  <span class="comment"># bail out of the LINE loop</span></span><br><span class="line">    <span class="keyword">last</span> WORD <span class="keyword">if</span> /EOL/;      <span class="comment"># skip the rest of the line</span></span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>label可以用来与last,next和redo配合，实现精确跳转。</p>
<h3 id="条件操作符"><a href="#条件操作符" class="headerlink" title="条件操作符"></a>条件操作符</h3><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">expression ? if_true_expr : if_false_expr</span><br></pre></td></tr></table></figure>

<p>写verilog的人最喜欢的东西。</p>
<h3 id="逻辑操作符"><a href="#逻辑操作符" class="headerlink" title="逻辑操作符"></a>逻辑操作符</h3><p>与C语言中的与<code>&amp;&amp;</code>或<code>||</code>非<code>!</code>相同。</p>
<h3 id="定义或操作符"><a href="#定义或操作符" class="headerlink" title="定义或操作符 \\"></a>定义或操作符 <code>\\</code></h3><p>定义或操作符的用途是，当左边的变量为undef时，将右边的值自动赋给左边，解决undef的问题。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"> <span class="keyword">foreach</span> <span class="keyword">my</span> $try ( <span class="number">0</span>, <span class="keyword">undef</span>, <span class="string">&#x27;0&#x27;</span>, <span class="number">1</span>, <span class="number">25</span> ) &#123;</span><br><span class="line">  <span class="keyword">print</span> <span class="string">&quot;Trying [$try] ---&gt; &quot;</span>;</span><br><span class="line">  <span class="keyword">my</span> $value = $try // <span class="string">&#x27;default&#x27;</span>;</span><br><span class="line">  <span class="keyword">say</span> <span class="string">&quot;\tgot [$value]&quot;</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-105.png"></p>
<p>可以看到，只有undef被设置为了’default’，而数字0和字符串’0’都不受影响。</p>
<h3 id="使用部分求值操作符进行控制"><a href="#使用部分求值操作符进行控制" class="headerlink" title="使用部分求值操作符进行控制"></a>使用部分求值操作符进行控制</h3><p>一个典型的例子是文件打开操作：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">open</span> <span class="keyword">my</span> $fh, <span class="string">&#x27;&lt;&#x27;</span>, $filename</span><br><span class="line">  <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">&quot;Can&#x27;t open &#x27;$filename&#x27;: $!&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="课后习题-1"><a href="#课后习题-1" class="headerlink" title="课后习题"></a>课后习题</h3><p><img src="/2024/05/08/LearnPerl/image-106.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"><span class="keyword">my</span> $magic_number = <span class="keyword">int</span>(<span class="number">1</span> + <span class="keyword">rand</span> <span class="number">100</span>);</span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;please guess a number in range (1,100):&quot;</span>;</span><br><span class="line"></span><br><span class="line">GUESSAGAIN: &#123;   </span><br><span class="line">        <span class="keyword">chomp</span>(<span class="keyword">my</span> $gauss = &lt;STDIN&gt;);</span><br><span class="line">        <span class="keyword">if</span> ($gauss &gt; $magic_number)&#123;</span><br><span class="line">            <span class="keyword">say</span> <span class="string">&quot;Guess something smaller&quot;</span>;</span><br><span class="line">            <span class="keyword">redo</span> GUESSAGAIN;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">elsif</span>($gauss &lt; $magic_number) &#123;</span><br><span class="line">            <span class="keyword">say</span> <span class="string">&quot;Guess something bigger&quot;</span>;</span><br><span class="line">            <span class="keyword">redo</span> GUESSAGAIN;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">say</span> <span class="string">&quot;You are right!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image-109.png"></p>
<p><img src="/2024/05/08/LearnPerl/image-110.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> $magic_number = <span class="keyword">int</span>(<span class="number">1</span> + <span class="keyword">rand</span> <span class="number">100</span>);</span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;please guess a number in range (1,100):&quot;</span>;</span><br><span class="line"></span><br><span class="line">GUESSAGAIN: &#123;   </span><br><span class="line">        <span class="keyword">chomp</span>(<span class="keyword">my</span> $guess = &lt;STDIN&gt;);</span><br><span class="line">        <span class="keyword">if</span> ($guess =~ <span class="regexp">/\D/</span> &amp;&amp; $guess !~ <span class="regexp">/^q$/</span> &amp;&amp; $guess !~ <span class="regexp">/^y/</span>)&#123;</span><br><span class="line">            <span class="keyword">say</span> <span class="string">&quot;Wanna some implications? or enter q to quit&quot;</span>;</span><br><span class="line">            <span class="keyword">redo</span> GUESSAGAIN;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ($guess =~ <span class="regexp">/^q$/</span>)&#123;</span><br><span class="line">            <span class="keyword">say</span> <span class="string">&quot;Alright, have a nice day&quot;</span>;</span><br><span class="line">            <span class="keyword">last</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">elsif</span> ($guess =~ <span class="regexp">/y/</span>)&#123;</span><br><span class="line">            <span class="keyword">say</span> <span class="string">&quot;All right&quot;</span>;</span><br><span class="line">            IMPLICATION: &#123;</span><br><span class="line">                    <span class="keyword">my</span> ($first_char) = $magic_number =~ <span class="regexp">/^(.).*/</span>;</span><br><span class="line">                    <span class="keyword">say</span> <span class="string">&quot;The number start with $first_char&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">redo</span> GUESSAGAIN;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ($guess &gt; $magic_number)&#123;</span><br><span class="line">            <span class="keyword">say</span> <span class="string">&quot;Guess something smaller&quot;</span>;</span><br><span class="line">            <span class="keyword">redo</span> GUESSAGAIN;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">elsif</span>($guess &lt; $magic_number) &#123;</span><br><span class="line">            <span class="keyword">say</span> <span class="string">&quot;Guess something bigger&quot;</span>;</span><br><span class="line">            <span class="keyword">redo</span> GUESSAGAIN;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">say</span> <span class="string">&quot;You are right!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>没看懂题目啥意思，自己写了一个娱乐版。</p>
<p><img src="/2024/05/08/LearnPerl/image-111.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> <span class="keyword">my</span> $key (<span class="keyword">sort</span> <span class="keyword">keys</span> %ENV)&#123;</span><br><span class="line">       <span class="keyword">say</span> <span class="string">&quot;$key is not defined&quot;</span> </span><br><span class="line">        <span class="keyword">unless</span> $ENV&#123;$key&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>




<h2 id="Ch11-Perl模块"><a href="#Ch11-Perl模块" class="headerlink" title="Ch11 Perl模块"></a>Ch11 Perl模块</h2><p>Perl模块发布网站：<a target="_blank" rel="noopener" href="https://metacpan.org/">https://metacpan.org/</a></p>
<p>使用<code>perldoc</code>命令可以查看Perl 模块的说明。</p>
<p><img src="/2024/05/08/LearnPerl/image-112.png"></p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p>使用cpan（Comprehensive Perl Archive Network）或cpanm命令。</p>
<h3 id="模块的使用"><a href="#模块的使用" class="headerlink" title="模块的使用"></a>模块的使用</h3><h4 id="File-Basename-使用"><a href="#File-Basename-使用" class="headerlink" title="File::Basename 使用"></a>File::Basename 使用</h4><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> File::Basename;</span><br><span class="line"><span class="keyword">my</span> $name = <span class="string">&quot;/usr/local/bin/perl&quot;</span>;</span><br><span class="line"><span class="keyword">my</span> $basename = basename $name;  <span class="comment"># gives &#x27;perl&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> $basename;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-113.png"></p>
<p>在代码开头使用<code>use</code>命令，可以完成模块的挂载。</p>
<h4 id="使用部分函数"><a href="#使用部分函数" class="headerlink" title="使用部分函数"></a>使用部分函数</h4><p>在导入时可以自定义需要导入的函数，避免命名冲突。<br><code> use File::Basename qw/ basename /;</code></p>
<p>即使不导入任何函数，也可以用全名的方式调用函数：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">my</span> $name = <span class="string">&quot;/usr/local/bin/perl&quot;</span>;</span><br><span class="line"><span class="keyword">my</span> $dirname = File::Basename::dirname $name;  <span class="comment"># dirname from the module</span></span><br></pre></td></tr></table></figure>

<h4 id="spec模块"><a href="#spec模块" class="headerlink" title="spec模块"></a>spec模块</h4><p>spec模块使用面向对象：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> File::Basename;</span><br><span class="line"><span class="keyword">use</span> File::Spec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;Please enter a filename: &quot;</span>;</span><br><span class="line"><span class="keyword">chomp</span>(<span class="keyword">my</span> $old_name = &lt;STDIN&gt;);</span><br><span class="line"><span class="keyword">my</span> $dirname  = dirname $old_name;</span><br><span class="line"><span class="keyword">my</span> $basename = basename $old_name;</span><br><span class="line">$basename =~ <span class="regexp">s/^/not/</span>; </span><br><span class="line"><span class="keyword">my</span> $new_name = File::Spec-&gt;catfile($dirname, $basename);</span><br><span class="line"><span class="keyword">rename</span>($old_name, $new_name)</span><br><span class="line">    <span class="keyword">or</span> <span class="keyword">warn</span> <span class="string">&quot;Can&#x27;t rename &#x27;$old_name&#x27; to &#x27;$new_name&#x27;: $!&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>和C++类似，通过<code>-&gt;</code>调用对象中的函数。</p>
<h4 id="DBI-（Database-Interface）模块"><a href="#DBI-（Database-Interface）模块" class="headerlink" title="DBI （Database Interface）模块"></a>DBI （Database Interface）模块</h4><p>略</p>
<h4 id="时间和日期的模块"><a href="#时间和日期的模块" class="headerlink" title="时间和日期的模块"></a>时间和日期的模块</h4><p>使用<code>Time::Moment</code>模块：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"><span class="keyword">use</span>  Time::Moment;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> $dt = Time::Moment-&gt;now;</span><br><span class="line"><span class="keyword">printf</span> <span class="string">&quot;%4d%02d%02d \n&quot;</span>, $dt-&gt;year, $dt-&gt;month, $dt-&gt;day_of_month;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image-114.png"></p>
<h3 id="习题-6"><a href="#习题-6" class="headerlink" title="习题"></a>习题</h3><p><img src="/2024/05/08/LearnPerl/image-115.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"><span class="keyword">use</span>  Module::CoreList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> %modules = %&#123; $Module::CoreList::version&#123;<span class="number">5.024</span>&#125; &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment"># print %modules;</span></span><br><span class="line"><span class="keyword">foreach</span> <span class="keyword">my</span> $key (<span class="keyword">keys</span> %modules)&#123;</span><br><span class="line">    <span class="keyword">say</span> <span class="string">&quot;$key =&gt; $modules&#123;$key&#125;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-116.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"><span class="keyword">use</span>  Time::Moment;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> $dt = Time::Moment-&gt;now;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> $input_dt = Time::Moment-&gt;new(</span><br><span class="line">    <span class="string">year =&gt;</span> @ARGV[<span class="number">0</span>],</span><br><span class="line">    <span class="string">month =&gt;</span> @ARGV[<span class="number">1</span>],</span><br><span class="line">    <span class="string">day        =&gt;</span> @ARGV[<span class="number">2</span>],</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> $years  = $input_dt-&gt;delta_years( $dt );</span><br><span class="line"><span class="keyword">my</span> $months  = $input_dt-&gt;delta_months( $dt ) % <span class="number">12</span>;</span><br><span class="line"><span class="keyword">my</span> $days  = $input_dt-&gt;delta_days( $dt )  % <span class="number">30</span>;</span><br><span class="line"><span class="keyword">printf</span> <span class="string">&quot;%d years,%d months and  %d days \n&quot;</span>,$years,$months,$days;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-117.png"></p>
<h2 id="Ch12-文件测试"><a href="#Ch12-文件测试" class="headerlink" title="Ch12 文件测试"></a>Ch12 文件测试</h2><h3 id="文件测试操作符"><a href="#文件测试操作符" class="headerlink" title="文件测试操作符"></a>文件测试操作符</h3><p>使用<code>perldoc -f -X</code>可查看文档:<br><img src="/2024/05/08/LearnPerl/image-118.png"></p>
<p>例如，查看文件是否存在,使用<code>-e</code>操作。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> $filename=<span class="string">&quot;test.txt&quot;</span>;</span><br><span class="line"><span class="keyword">die</span> <span class="string">&quot;Oops! A file called &#x27;$filename&#x27; already exists.\n&quot;</span></span><br><span class="line">  <span class="keyword">if</span> -e $filename;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image-119.png"></p>
<p>统计大于100K且90天未使用的文件：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">my</span> @original_files = <span class="keyword">qw</span>/ fred barney betty wilma pebbles dino bamm-bamm /;</span><br><span class="line"><span class="keyword">my</span> @big_old_files;  <span class="comment"># The ones we want to put on backup tapes</span></span><br><span class="line"><span class="keyword">foreach</span> <span class="keyword">my</span> $filename (@original_files) &#123;</span><br><span class="line"> <span class="keyword">push</span> @big_old_files, $filename</span><br><span class="line">   <span class="keyword">if</span> -s $filename &gt; <span class="number">100_000</span> <span class="keyword">and</span> -A $filename &gt; <span class="number">90</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>一些常用的文件测试操作：<br><img src="/2024/05/08/LearnPerl/image-120.png"><br><img src="/2024/05/08/LearnPerl/image-121.png" alt="alt text"></p>
<p>大部分测试操作返回一个布尔值，<code>-s</code>是个例外，会返回文件大小。在希望对返回的大小进行操作，比如更换统计单位时，需要注意。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># The filename is in $_</span></span><br><span class="line"><span class="keyword">my</span> $size_in_K = -s / <span class="number">1000</span>;  <span class="comment"># Oops!</span></span><br></pre></td></tr></table></figure>
<p> 上述写法会报错，perl不会识别除法，而是将其当作-s的选项导致报错。上述操作应该写成：<br> <figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">my</span> $size_in_k = (-s) / <span class="number">1024</span>;  <span class="comment"># Uses $_ by default</span></span><br></pre></td></tr></table></figure></p>
<h3 id="测试同一文件的多个属性"><a href="#测试同一文件的多个属性" class="headerlink" title="测试同一文件的多个属性"></a>测试同一文件的多个属性</h3> <figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (-r $filename <span class="keyword">and</span> -w $filename) &#123;</span><br><span class="line"> ... &#125;</span><br></pre></td></tr></table></figure>

<p> 上述写法可以用虚文件句柄来进行简写：</p>
 <figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (-r $filename <span class="keyword">and</span> -w <span class="number">_</span>) &#123;</span><br><span class="line">   ... &#125;</span><br></pre></td></tr></table></figure>


<h3 id="栈式文件测试操作符"><a href="#栈式文件测试操作符" class="headerlink" title="栈式文件测试操作符"></a>栈式文件测试操作符</h3><p> perl5.10之后的版本可以支持一次性列出所有的文件操作。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"> <span class="keyword">if</span> (-r -w -<span class="keyword">x</span> -o -d $filename) &#123;</span><br><span class="line">  <span class="keyword">print</span> <span class="string">&quot;My directory is readable, writable, and executable!\n&quot;</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<h3 id="stat和lstat函数"><a href="#stat和lstat函数" class="headerlink" title="stat和lstat函数"></a>stat和lstat函数</h3><p>perl的stat函数和unix的系统调用stat类似，会返回丰富的信息。</p>
<h4 id="一些重要的文件信息"><a href="#一些重要的文件信息" class="headerlink" title="一些重要的文件信息"></a>一些重要的文件信息</h4><h5 id="dev和-ino"><a href="#dev和-ino" class="headerlink" title="$dev和$ino"></a>$dev和$ino</h5><p>文件设备编号和文件inode编号，保证了文件的唯一性。</p>
<h5 id="mode"><a href="#mode" class="headerlink" title="$mode"></a>$mode</h5><p>文件的权限位集合。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">my</span>($dev, $ino, $mode, $nlink, $uid, $gid, $rdev,</span><br><span class="line">  $size, $atime, $mtime, $ctime, $blksize, $blocks)</span><br><span class="line">    = <span class="keyword">stat</span>(<span class="string">&quot;test.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> $mode;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-122.png"></p>
<p>上述代码返回33188,对应八进制数100644。去掉最高位的 1，表示文件类型为普通文件，剩下的 0644 就是文件的权限。<br>即rw-r–r–.</p>
<h5 id="nlink"><a href="#nlink" class="headerlink" title="$nlink"></a>$nlink</h5><p>文件或目录的硬链接数</p>
<h5 id="uid和-gid"><a href="#uid和-gid" class="headerlink" title="$uid和$gid"></a>$uid和$gid</h5><p>以数值形式表示的文件拥有者的用户ID及用户组ID。</p>
<h5 id="size"><a href="#size" class="headerlink" title="$size"></a>$size</h5><p>以字节为单位的文件大小，和-s操作符的返回值相同。</p>
<h5 id="atime-mtime-time"><a href="#atime-mtime-time" class="headerlink" title="$atime,$mtime,$time"></a>$atime,$mtime,$time</h5><p>3种时间戳</p>
<p>对链接符号调用stat会返回其指向的对象的信息，而非链接符号本身的信息，如果想获得连接符号本身的信息，可以用lstat代替，stat，但这多半没什么用。</p>
<p>ps:链接符号是一个指向另一个文件或目录的指针。符号链接本身（Symbolic Link Itself）：是指这个指针文件，它有自己的文件属性，如大小、权限、所有者等。</p>
<p>例如：<br><code>ln -s original.txt link.txt</code><br>创建了一个链接符号，link是连接符号本身，original是原文件。</p>
<h3 id="localtime函数"><a href="#localtime函数" class="headerlink" title="localtime函数"></a>localtime函数</h3><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> $timestamp = <span class="number">1454133253</span>;</span><br><span class="line"><span class="keyword">my</span> $date = <span class="keyword">localtime</span> $timestamp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;date: $date&quot;</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image-123.png"></p>
<p>用于将时间戳转化为人类更容易理解的方式。</p>
<h3 id="按位运算操作符"><a href="#按位运算操作符" class="headerlink" title="按位运算操作符"></a>按位运算操作符</h3><p>与verilog和C中的一样：</p>
<p><img src="/2024/05/08/LearnPerl/image-124.png"></p>
<h3 id="按位操作字符串"><a href="#按位操作字符串" class="headerlink" title="按位操作字符串"></a>按位操作字符串</h3><p>由于perl的上下文特性，对字符串的按位操作会返回字符串，对整数的按位操作会返回整数。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> $s =  <span class="string">&quot;\xAA&quot;</span> | <span class="string">&quot;\x55&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> <span class="keyword">ord</span>($s);</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-125.png"></p>
<h3 id="课后习题-2"><a href="#课后习题-2" class="headerlink" title="课后习题"></a>课后习题</h3><p><img src="/2024/05/08/LearnPerl/image-126.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (@ARGV)&#123;</span><br><span class="line">    <span class="keyword">if</span>(-e -r -w -<span class="keyword">x</span> )&#123;</span><br><span class="line">        <span class="keyword">say</span> <span class="string">&quot;$_ exists and is readable,writable and executable !&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">say</span> <span class="string">&quot;$_ not exist or  is not readable,writable and executable! !&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image-127.png"></p>
<p><img src="/2024/05/08/LearnPerl/image-128.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> $filename=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">my</span> $age=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">foreach</span> (@ARGV)&#123;</span><br><span class="line">    <span class="keyword">if</span>(-A &gt; $age )&#123;</span><br><span class="line">        $age = -A $_ ;</span><br><span class="line">        $filename = $_;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;The oldest file is $filename and it has existed for $age days&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-129.png"></p>
<p><img src="/2024/05/08/LearnPerl/image-130.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (@ARGV)&#123;</span><br><span class="line">   <span class="keyword">if</span> (-r -w -O)&#123;</span><br><span class="line">        <span class="keyword">say</span> <span class="string">&quot;You own file $_ and its readable and writable&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-131.png"></p>
<h2 id="Ch13-目录操作"><a href="#Ch13-目录操作" class="headerlink" title="Ch13 目录操作"></a>Ch13 目录操作</h2><h3 id="当前工作目录-在目录树中移动"><a href="#当前工作目录-在目录树中移动" class="headerlink" title="当前工作目录&#x2F;在目录树中移动"></a>当前工作目录&#x2F;在目录树中移动</h3><p>使用<code>chdir</code>操作来改变当前的工作目录,类似shell中的cd命令。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"><span class="keyword">use</span> Cwd;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;The current working directory is &quot;</span>, getcwd();</span><br><span class="line"><span class="keyword">chdir</span> <span class="string">&#x27;/etc&#x27;</span> <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">&quot;cannot chdir to /etc: $!&quot;</span>;</span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;The current working directory is &quot;</span>, getcwd();</span><br></pre></td></tr></table></figure>

<p>使用Cwd模块，可以获取当前工作目录，相当于pwd命令。</p>
<p>需要注意的是，在linux中我们常用<code>cd ~</code>命令来回到主目录，这在perl中是行不通的。可以使用如下方法先获得当前用户名，然后移动到用户名的主目录中：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">my</span> $username = <span class="keyword">getpwuid</span>($&lt;);</span><br><span class="line">$dir = <span class="string">&quot;/home/$username&quot;</span>;</span><br><span class="line"><span class="keyword">chdir</span> $dir;</span><br></pre></td></tr></table></figure>
<h3 id="通配globbing"><a href="#通配globbing" class="headerlink" title="通配globbing"></a>通配globbing</h3><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"><span class="keyword">use</span> Cwd;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">chdir</span> <span class="string">&#x27;../ch7/&#x27;</span>;</span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;The current working directory is &quot;</span>, getcwd();</span><br><span class="line"><span class="keyword">my</span> @files = <span class="keyword">glob</span> <span class="string">&quot;*.pl&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (@files)&#123;</span><br><span class="line">    <span class="keyword">say</span> <span class="string">&quot;I have file: $_&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-132.png"></p>
<p>例如，使用如下程序，用于统计所有回归测试的结果：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">14</span>;</span><br><span class="line"><span class="keyword">chdir</span> <span class="string">&#x27;./run&#x27;</span>;</span><br><span class="line"><span class="keyword">my</span> @test_list = <span class="keyword">glob</span> <span class="string">&quot;rv*/*.report&quot;</span>;</span><br><span class="line"><span class="keyword">my</span> $sum=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">my</span> $pass=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> @pass,<span class="keyword">my</span> @fail;</span><br><span class="line"><span class="keyword">foreach</span> <span class="keyword">my</span> $file(@test_list)&#123;</span><br><span class="line">    $sum++;</span><br><span class="line">    <span class="keyword">open</span> FILE,$file </span><br><span class="line">        <span class="keyword">or</span>  <span class="keyword">die</span> <span class="string">&quot;Could not open log:$file: $!&quot;</span>;</span><br><span class="line">    <span class="keyword">my</span> $lines = <span class="keyword">join</span> <span class="string">&#x27;&#x27;</span>, &lt;FILE&gt;;</span><br><span class="line">    <span class="keyword">close</span> FILE;</span><br><span class="line">    <span class="keyword">if</span> ($lines =~ <span class="regexp">/PASS/</span>)&#123;</span><br><span class="line">        $pass++;</span><br><span class="line">        <span class="keyword">push</span> @pass,$file =~ s|<span class="regexp">/.*||r;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">    else &#123;</span></span><br><span class="line"><span class="regexp">        push @fail,$file =~ s|/</span>.*||r;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">printf</span> <span class="string">&quot;TEST PASS: $pass/$sum \nPASS RATE:%6.2f %\n&quot;</span>,$pass/$sum*<span class="number">100</span> <span class="keyword">unless</span> $sum eq <span class="number">0</span>;</span><br><span class="line"><span class="keyword">say</span> <span class="string">&#x27;-&#x27;</span> <span class="keyword">x</span> <span class="number">35</span> . <span class="string">&quot;REGRESS  TEST  REPORT&quot;</span> . <span class="string">&#x27;-&#x27;</span> <span class="keyword">x</span> <span class="number">35</span>;</span><br><span class="line"><span class="keyword">say</span> <span class="string">&#x27;-&#x27;</span> <span class="keyword">x</span> <span class="number">35</span> . <span class="string">&quot;       TEST  PASS    &quot;</span> . <span class="string">&#x27;-&#x27;</span> <span class="keyword">x</span> <span class="number">35</span>;</span><br><span class="line"><span class="keyword">foreach</span> (@pass)&#123;</span><br><span class="line">    <span class="keyword">printf</span> <span class="string">&quot;|               PASS: %45s                       |\n&quot;</span>,$_;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;-&quot;</span>x92;</span><br><span class="line"><span class="keyword">say</span> <span class="string">&#x27;-&#x27;</span> <span class="keyword">x</span> <span class="number">35</span> . <span class="string">&quot;       TEST  FAIL    &quot;</span> . <span class="string">&#x27;-&#x27;</span> <span class="keyword">x</span> <span class="number">35</span>;</span><br><span class="line"><span class="keyword">foreach</span> (@fail)&#123;</span><br><span class="line">    <span class="keyword">printf</span> <span class="string">&quot;|               FAIL: %45s                       |\n&quot;</span>,$_;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;-&quot;</span>x92;</span><br></pre></td></tr></table></figure>

<p>效果如下：<br><img src="/2024/05/08/LearnPerl/image-134.png"></p>
<h3 id="通配的另一种语法"><a href="#通配的另一种语法" class="headerlink" title="通配的另一种语法"></a>通配的另一种语法</h3><p>采用glob的语法和尖括号的效果是一样的：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">my</span> @all_files = &lt;*&gt;;    <span class="comment"># exactly the same as my @all_files = glob &quot;*&quot;;</span></span><br></pre></td></tr></table></figure>

<p>由于尖括号同时代表文件名读取，因此perl内部有不同机制来辨别这两种操作：<br><img src="/2024/05/08/LearnPerl/image-133.png"></p>
<h3 id="目录句柄"><a href="#目录句柄" class="headerlink" title="目录句柄"></a>目录句柄</h3><p>使用 <code>opendir</code>和<code>readdir</code>可以进行目录操作：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">my</span> $dir_to_process = <span class="string">&#x27;/etc&#x27;</span>;</span><br><span class="line"><span class="keyword">opendir</span> <span class="keyword">my</span> $dh, $dir_to_process <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">&quot;Cannot open $dir_to_process: $!&quot;</span>;</span><br><span class="line"><span class="keyword">foreach</span> $file (<span class="keyword">readdir</span> $dh) &#123;</span><br><span class="line"> <span class="keyword">print</span> <span class="string">&quot;one file in $dir_to_process is $file\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">closedir</span> $dh;</span><br></pre></td></tr></table></figure>
<p>如果只想处理以.pm结尾的文件，可以写成：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> ($name = <span class="keyword">readdir</span> $dh) &#123;</span><br><span class="line"> <span class="keyword">next</span> <span class="keyword">unless</span> $name =~ <span class="regexp">/\.pm\z/</span>;</span><br><span class="line"> ... more processing ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>需要注意的是，<code>readdir</code>返回的是目录下的文件名列表，不含文件的完整路径。需要完整路径时需要手动补充完整：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">opendir</span> <span class="keyword">my</span> $somedir, $dirname <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">&quot;Cannot open $dirname: $!&quot;</span>;</span><br><span class="line"><span class="keyword">while</span> (<span class="keyword">my</span> $name = <span class="keyword">readdir</span> $somedir) &#123;</span><br><span class="line"> <span class="keyword">next</span> <span class="keyword">if</span> $name =~ <span class="regexp">/\A\./</span>;           <span class="comment"># skip over dot files</span></span><br><span class="line"> $name = <span class="string">&quot;$dirname/$name&quot;</span>;          <span class="comment"># patch up the path</span></span><br><span class="line"> <span class="keyword">next</span> <span class="keyword">unless</span> -f $name <span class="keyword">and</span> -r $name; <span class="comment"># only readable files</span></span><br><span class="line"> ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此外还可以使用<code>File::Spec::Functions</code>模块以适应任何操作系统。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> File::Spec::Functions;</span><br><span class="line"><span class="keyword">opendir</span> <span class="keyword">my</span> $somedir, $dirname <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">&quot;Cannot open $dirname: $!&quot;</span>;</span><br><span class="line"><span class="keyword">while</span> (<span class="keyword">my</span> $name = <span class="keyword">readdir</span> $somedir) &#123;</span><br><span class="line"> <span class="keyword">next</span> <span class="keyword">if</span> $name =~ <span class="regexp">/\A\./</span>;             <span class="comment"># skip over dot files</span></span><br><span class="line"> $name = catfile( $dirname, $name ); <span class="comment"># patch up the path</span></span><br><span class="line"> <span class="keyword">next</span> <span class="keyword">unless</span> -f $name <span class="keyword">and</span> -r $name;  <span class="comment"># only readable files</span></span><br><span class="line"> ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="删除文件"><a href="#删除文件" class="headerlink" title="删除文件"></a>删除文件</h3><p>使用<code>unlink</code>函数可以在perl内删除程序：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unlink</span> <span class="string">&#x27;slate&#x27;</span>, <span class="string">&#x27;bedrock&#x27;</span>, <span class="string">&#x27;lava&#x27;</span>;</span><br><span class="line"><span class="keyword">unlink</span> <span class="string">qw(slate bedrock lava)</span>;</span><br></pre></td></tr></table></figure>

<p>由于unlink可以接受列表作为参数，因此可以和glob配合，一次删除多个文件：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unlink</span> <span class="keyword">glob</span> <span class="string">&#x27;*.o&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p><code>unlink</code>的返回值是成功删除文件的个数，可以用来检验是否删除成功。</p>
<p>对于多个文件，还是采用循环的办法比较可靠，可以知道是否删除成功：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span> <span class="keyword">my</span> $file (<span class="string">qw(slate bedrock lava)</span>) &#123;</span><br><span class="line"> <span class="keyword">unlink</span> $file <span class="keyword">or</span> <span class="keyword">warn</span> <span class="string">&quot;failed on $file: $!\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="重命名文件"><a href="#重命名文件" class="headerlink" title="重命名文件"></a>重命名文件</h3><p>使用<code>rename</code>函数可以重命名文件，加上完整的目录可以实现移动的效果(类比mv 命令)。使用胖箭头可以更清楚的表示改名前后的名称。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">rename</span> <span class="string">&#x27;old&#x27;</span>, <span class="string">&#x27;new&#x27;</span>；</span><br><span class="line"><span class="keyword">rename</span> <span class="string">&#x27;over_there/some/place/some_file&#x27;</span>, <span class="string">&#x27;some_file&#x27;</span>;</span><br><span class="line"><span class="keyword">rename</span> <span class="string">&#x27;over_there/some/place/some_file&#x27;</span> =&gt; <span class="string">&#x27;some_file&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>rename失败会返回<code>false</code>,并将文件名报错在<code>$!</code>变量中。</p>
<p>一个场景的使用场景是将所有old结尾的文件改为new结尾，程序如下：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span> <span class="keyword">my</span> $file (<span class="keyword">glob</span> <span class="string">&quot;*.old&quot;</span>) &#123;</span><br><span class="line"> <span class="keyword">my</span> $newfile = $file;</span><br><span class="line"> $newfile =~ <span class="regexp">s/\.old$/.new/</span>;</span><br><span class="line"> <span class="keyword">if</span> (-e $newfile) &#123;</span><br><span class="line">   <span class="keyword">warn</span> <span class="string">&quot;can&#x27;t rename $file to $newfile: $newfile exists\n&quot;</span>;</span><br><span class="line"> &#125; <span class="keyword">elsif</span> (<span class="keyword">rename</span> $file =&gt; $newfile) &#123;</span><br><span class="line">   <span class="comment"># success, do nothing</span></span><br><span class="line"> &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">   <span class="keyword">warn</span> <span class="string">&quot;rename $file to $newfile failed: $!\n&quot;</span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="链接与文件"><a href="#链接与文件" class="headerlink" title="链接与文件"></a>链接与文件</h3><p>在 Unix 和类似 Unix 的操作系统中，硬链接（Hard Link）和软链接（Soft Link，也称为符号链接，Symbolic Link）是两种用于创建文件系统链接的方法。它们之间有一些重要的区别和相似之处：</p>
<p><strong>硬链接（Hard Link）<br>定义：</strong><br>硬链接是指向文件数据块的直接引用。它是文件系统的多重引用，即同一个数据块可以有多个路径名。<br>硬链接创建了一个文件名和数据块之间的多重引用。</p>
<p>特性：</p>
<ol>
<li>共享相同的 inode：硬链接和源文件共享相同的 inode 编号，因此它们是完全等价的，任何一个被修改都会影响到另一个。</li>
<li>删除效果：删除一个硬链接不会删除文件数据，只有当所有指向文件数据块的硬链接都被删除时，文件数据才会被删除。</li>
<li>不跨文件系统：硬链接只能在同一个文件系统内创建，不能跨越不同的文件系统。</li>
<li>目录限制：不能为目录创建硬链接（除非具有超级用户权限且特定情况下）。</li>
</ol>
<p><code>ln source_file hard_link</code></p>
<p><strong>软链接（Soft Link 或 Symbolic Link）<br>定义：</strong></p>
<p>软链接是一个指向另一个文件路径的特殊文件。它包含了目标文件的路径名，而不是直接指向文件数据块。<br>软链接是一种间接引用。<br><strong>特性：</strong></p>
<ol>
<li>不同的 inode：软链接有自己独立的 inode 编号，与目标文件不同。</li>
<li>删除效果：删除软链接不会删除目标文件数据，但如果目标文件被删除，软链接将变为无效的悬挂链接（Dangling Link）。</li>
<li>可以跨文件系统：软链接可以指向不同文件系统上的文件或目录。</li>
<li>目录链接：可以为目录创建软链接。</li>
</ol>
<p><code>ln -s target_file symbolic_link</code></p>
<h3 id="创建和删除目录"><a href="#创建和删除目录" class="headerlink" title="创建和删除目录"></a>创建和删除目录</h3><p>调用mkdir就可以直接创建目录：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">mkdir</span> <span class="string">&#x27;fred&#x27;</span>, <span class="number">0755</span> <span class="keyword">or</span> <span class="keyword">warn</span> <span class="string">&quot;Cannot make fred directory: $!&quot;</span>;</span><br></pre></td></tr></table></figure>
<p>这里0755是八进制的目录权限。</p>
<p>使用<code>rmdir</code>可以删除目录：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span> <span class="keyword">my</span> $dir (<span class="string">qw(fred barney betty)</span>) &#123;</span><br><span class="line">  <span class="keyword">rmdir</span> $dir <span class="keyword">or</span> <span class="keyword">warn</span> <span class="string">&quot;cannot rmdir $dir: $!\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>与<code>unlink</code>不同的是<code>rmdir</code>每次只能删除一个目录，且不能删除非空目录，需要先使用<code>unlink</code>将其中的文件删除。</p>
<h3 id="修改权限"><a href="#修改权限" class="headerlink" title="修改权限"></a>修改权限</h3><p>类似Unix，使用<code>chmod</code>可以修改文件权限。但是不可以接受+x这样的参数：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">chmod</span> <span class="number">0755</span>, <span class="string">&#x27;fred&#x27;</span>, <span class="string">&#x27;barney&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="修改隶属关系"><a href="#修改隶属关系" class="headerlink" title="修改隶属关系"></a>修改隶属关系</h3><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">my</span> $user  = <span class="number">1004</span>;</span><br><span class="line"><span class="keyword">my</span> $group = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">chown</span> $user, $group, <span class="keyword">glob</span> <span class="string">&#x27;*.o&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>使用<code>getpwname</code>和<code>getgpname</code>可以获得对应的用户名和用户组名的编号：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">defined</span>(<span class="keyword">my</span> $user = <span class="keyword">getpwnam</span> <span class="string">&#x27;merlyn&#x27;</span>) <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">&#x27;bad user&#x27;</span>;</span><br><span class="line"><span class="keyword">defined</span>(<span class="keyword">my</span> $group = <span class="keyword">getgrnam</span> <span class="string">&#x27;users&#x27;</span>) <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">&#x27;bad group&#x27;</span>;</span><br><span class="line"><span class="keyword">chown</span> $user, $group, <span class="keyword">glob</span> <span class="string">&#x27;/home/merlyn/*&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="修改时间戳"><a href="#修改时间戳" class="headerlink" title="修改时间戳"></a>修改时间戳</h3><p>使用<code>utime</code>可以修改时间戳：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">my</span> $now = <span class="keyword">time</span>;</span><br><span class="line"><span class="keyword">my</span> $ago = $now - <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span>;  <span class="comment"># seconds per day</span></span><br><span class="line"><span class="keyword">utime</span> $now, $ago, <span class="keyword">glob</span> <span class="string">&#x27;*&#x27;</span>;     <span class="comment"># set access to now, mod to a day ago</span></span><br></pre></td></tr></table></figure>
<p>第一个参数是访问时间，第二个参数是修改时间。</p>
<h3 id="习题-7"><a href="#习题-7" class="headerlink" title="习题"></a>习题</h3><p><img src="/2024/05/08/LearnPerl/image-135.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"><span class="keyword">use</span> Cwd;</span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;Please give me a directory:&quot;</span>;</span><br><span class="line"><span class="keyword">chomp</span>(<span class="keyword">my</span> $dir = &lt;&gt;);</span><br><span class="line"><span class="keyword">my</span> $username = <span class="keyword">getpwuid</span>($&lt;);</span><br><span class="line">$dir = <span class="string">&quot;/home/$username&quot;</span> <span class="keyword">unless</span> $dir;</span><br><span class="line"><span class="keyword">chdir</span> $dir;</span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;The current working directory is &quot;</span>, getcwd();</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> @files = <span class="keyword">glob</span> <span class="string">&quot;*&quot;</span>;</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">sort</span> @files)&#123;</span><br><span class="line">    <span class="keyword">say</span> <span class="string">&quot;You have file/dirctory: $_&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-136.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"><span class="keyword">use</span> Cwd;</span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;Please give me a directory:&quot;</span>;</span><br><span class="line"><span class="keyword">chomp</span>(<span class="keyword">my</span> $dir = &lt;&gt;);</span><br><span class="line"><span class="keyword">my</span> $username = <span class="keyword">getpwuid</span>($&lt;);</span><br><span class="line">$dir = <span class="string">&quot;/home/$username&quot;</span> <span class="keyword">unless</span> $dir;</span><br><span class="line"><span class="keyword">chdir</span> $dir;</span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;The current working directory is &quot;</span>, getcwd();</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> @files = <span class="keyword">glob</span> <span class="string">&quot;.* *&quot;</span>;</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">sort</span> @files)&#123;</span><br><span class="line">    <span class="keyword">say</span> <span class="string">&quot;You have file/dirctory: $_&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-137.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"><span class="keyword">use</span> Cwd;</span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;Please give me a directory:&quot;</span>;</span><br><span class="line"><span class="keyword">chomp</span>(<span class="keyword">my</span> $dir = &lt;&gt;);</span><br><span class="line"><span class="keyword">my</span> $username = <span class="keyword">getpwuid</span>($&lt;);</span><br><span class="line">$dir = <span class="string">&quot;/home/$username&quot;</span> <span class="keyword">unless</span> $dir;</span><br><span class="line"><span class="keyword">chdir</span> $dir;</span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;The current working directory is &quot;</span>, getcwd();</span><br><span class="line"></span><br><span class="line"><span class="keyword">opendir</span> <span class="keyword">my</span> $dh, $dir <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">&quot;Cannot open $dir: $!&quot;</span>;</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">sort</span> <span class="keyword">readdir</span> $dh)&#123;</span><br><span class="line">    <span class="keyword">say</span> <span class="string">&quot;You have file/dirctory: $_&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">closedir</span> $dh;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-138.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"><span class="keyword">use</span> Cwd;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">rm_dir</span></span>()&#123;</span><br><span class="line">    <span class="keyword">my</span> ($dir) = @_;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span> <span class="keyword">unless</span> -d $dir;</span><br><span class="line">    <span class="keyword">my</span> $current_dir = getcwd();</span><br><span class="line">    <span class="keyword">chdir</span> $dir <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">&quot;Cannot change directory to $dir: $!&quot;</span>;</span><br><span class="line">    <span class="keyword">foreach</span> <span class="keyword">my</span> $file (<span class="keyword">glob</span> <span class="string">&quot;*&quot;</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> (-f $file)&#123;</span><br><span class="line">                <span class="keyword">unlink</span> $file <span class="keyword">or</span> <span class="keyword">warn</span> <span class="string">&quot;failed on $file: $!\n&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (-d $file)&#123;</span><br><span class="line">                rm_dir($file);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">chdir</span> $current_dir <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">&quot;Cannot change directory to $current_dir: $!&quot;</span>;</span><br><span class="line">    <span class="keyword">rmdir</span> $dir <span class="keyword">or</span> <span class="keyword">warn</span> <span class="string">&quot;Failed to remove directory $dir: $!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (@ARGV)&#123;</span><br><span class="line">    <span class="keyword">next</span> <span class="keyword">unless</span> -e;</span><br><span class="line">    <span class="keyword">if</span>(-d)&#123;</span><br><span class="line">        &amp;rm_dir($_);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(-f)&#123;</span><br><span class="line">        <span class="keyword">unlink</span> $_ <span class="keyword">or</span> <span class="keyword">warn</span> <span class="string">&quot;failed on $_: $!\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>由于rmdir无法直接删除目录，使用递归进行嵌套操作。<br>假设有如下文件关系：<br><img src="/2024/05/08/LearnPerl/image-140.png"><br><img src="/2024/05/08/LearnPerl/image-141.png"><br>删除效果如下：<br><img src="/2024/05/08/LearnPerl/image-142.png"></p>
<p><img src="/2024/05/08/LearnPerl/image-143.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"><span class="keyword">use</span> Cwd;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> $cwd = getcwd();</span><br><span class="line"><span class="keyword">my</span> $old_name=@ARGV[<span class="number">0</span>], <span class="keyword">my</span> $new_name=@ARGV[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(-e $new_name)&#123;</span><br><span class="line">    <span class="keyword">warn</span> <span class="string">&quot;can&#x27;t rename $old_name to $new_name: $new_name exists\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">elsif</span> (-d $old_name)&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">rename</span> <span class="string">&quot;$cwd/$old_name&quot;</span> =&gt; <span class="string">&quot;$cwd/$new_name&quot;</span>)&#123;&#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">warn</span> <span class="string">&quot;rename $old_name to $new_name failed: $!\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">rename</span> $old_name =&gt; $new_name)&#123;&#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">warn</span> <span class="string">&quot;rename $old_name to $new_name failed: $!\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="Ch14-字符串与排序"><a href="#Ch14-字符串与排序" class="headerlink" title="Ch14 字符串与排序"></a>Ch14 字符串与排序</h2><h3 id="用index查找子字符串"><a href="#用index查找子字符串" class="headerlink" title="用index查找子字符串"></a>用index查找子字符串</h3><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">my</span> $where = <span class="keyword">index</span>($big, $small);</span><br></pre></td></tr></table></figure>

<p>查找small在big中第一次出现的位置。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">my</span> $stuff = <span class="string">&quot;Howdy world!&quot;</span>;</span><br><span class="line"><span class="keyword">my</span> $where = <span class="keyword">index</span>($stuff, <span class="string">&quot;wor&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>还可以加上第三个参数，代表从指定的位置开始寻找：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">my</span> $stuff  = <span class="string">&quot;Howdy world!&quot;</span>;</span><br><span class="line"><span class="keyword">my</span> $where1 = <span class="keyword">index</span>($stuff, <span class="string">&quot;w&quot;</span>);               <span class="comment"># $where1 gets 2</span></span><br><span class="line"><span class="keyword">my</span> $where2 = <span class="keyword">index</span>($stuff, <span class="string">&quot;w&quot;</span>, $where1 + <span class="number">1</span>);  <span class="comment"># $where2 gets 6</span></span><br><span class="line"><span class="keyword">my</span> $where3 = <span class="keyword">index</span>($stuff, <span class="string">&quot;w&quot;</span>, $where2 + <span class="number">1</span>);  <span class="comment"># $where3 gets -1 (not found)</span></span><br></pre></td></tr></table></figure>

<p>下面是一个完整的示例：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"> <span class="keyword">my</span> $stuff  = <span class="string">&quot;Howdy world!&quot;</span>;</span><br><span class="line"> <span class="keyword">my</span> @where = ();</span><br><span class="line"> <span class="keyword">my</span> $where = -<span class="number">1</span>;</span><br><span class="line"> <span class="keyword">while</span>( <span class="number">1</span> ) &#123;</span><br><span class="line">  $where = <span class="keyword">index</span>( $stuff, <span class="string">&#x27;w&#x27;</span>, $where + <span class="number">1</span> );</span><br><span class="line">  <span class="keyword">last</span> <span class="keyword">if</span> $where == -<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">push</span> @where, $where;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">say</span> <span class="string">&quot;Positions are @where&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-144.png"></p>
<p>如果需要从后往前查找，则使用<code>rindex</code>:</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">my</span> $last_slash = <span class="keyword">rindex</span>(<span class="string">&quot;/etc/passwd&quot;</span>, <span class="string">&quot;/&quot;</span>);  <span class="comment"># value is 4</span></span><br></pre></td></tr></table></figure>

<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"> <span class="keyword">my</span> $fred = <span class="string">&quot;Yabba dabba doo!&quot;</span>;</span><br><span class="line"> <span class="keyword">my</span> @where = ();</span><br><span class="line"> <span class="keyword">my</span> $where = <span class="keyword">length</span> $fred;</span><br><span class="line"> <span class="keyword">while</span>(  ) &#123;</span><br><span class="line">  $where = <span class="keyword">rindex</span>($fred, <span class="string">&quot;abba&quot;</span>, $where - <span class="number">1</span> )</span><br><span class="line">  <span class="keyword">last</span> <span class="keyword">if</span> $where == -<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">push</span> @where, $where;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">say</span> <span class="string">&quot;Positions are @where&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="用substr操作子字符串"><a href="#用substr操作子字符串" class="headerlink" title="用substr操作子字符串"></a>用substr操作子字符串</h3><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">my</span> $part = <span class="keyword">substr</span>($string, $initial_position, $length);</span><br></pre></td></tr></table></figure>
<p>substr的第一个参数是要操作的字符串，第二个是起始位置，第三个是长度。</p>
<p>如果想要一直取到末尾，则第三个参数可以省略。</p>
<p>substr可以与index配合使用：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">my</span> $long = <span class="string">&quot;some very very long string&quot;</span>;</span><br><span class="line"><span class="keyword">my</span> $right = <span class="keyword">substr</span>($long, <span class="keyword">index</span>($long, <span class="string">&quot;l&quot;</span>) );<span class="comment"># &quot;long string&quot;</span></span><br></pre></td></tr></table></figure>

<p>当字符串被存储在变量中时，可以用substr来替换变量的内容：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> $string = <span class="string">&quot;Hello, world!&quot;</span>;</span><br><span class="line"><span class="keyword">substr</span>($string, <span class="number">0</span>, <span class="number">5</span>) = <span class="string">&quot;Goodbye&quot;</span>;  <span class="comment"># &quot;Goodbye, world!</span></span><br><span class="line"><span class="keyword">say</span> $string;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-145.png"></p>
<p>如果第三个长度参数设置成0，则相当于插入操作：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">substr</span>($string, <span class="number">9</span>, <span class="number">0</span>) = <span class="string">&quot;cruel&quot;</span>;    <span class="comment"># &quot;Goodbye, cruel world!&quot;;</span></span><br></pre></td></tr></table></figure>

<p>以及可以用正则表达式进行详细的编辑：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">substr</span>($string, -<span class="number">20</span>) =~ <span class="regexp">s/fred/barney/g</span>;</span><br></pre></td></tr></table></figure>
<p>上述操作会将字符串末尾的20个字符中的fred替换为barney.</p>
<h3 id="用sprintf格式化字符串"><a href="#用sprintf格式化字符串" class="headerlink" title="用sprintf格式化字符串"></a>用sprintf格式化字符串</h3><p>sprintf和printf拥有相同的参数，但返回的是请求的字符串，而不会将其打印出来。<br>例如：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">my</span> $date_tag = <span class="keyword">sprintf</span></span><br><span class="line"> <span class="string">&quot;%4d/%02d/%02d %2d:%02d:%02d&quot;</span>,</span><br><span class="line"> $yr, $mo, $da, $h, $m, $s;</span><br></pre></td></tr></table></figure>

<p>按照格式编辑好字符串，从而方便下一步操作。</p>
<h4 id="用sprintf格式化金额数字"><a href="#用sprintf格式化金额数字" class="headerlink" title="用sprintf格式化金额数字"></a>用sprintf格式化金额数字</h4><p>例如，想让一个金额数字保留2位有效数字，并且大额数字每3位加上一个逗号，可以使用如下程序：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">big_money</span> </span>&#123;</span><br><span class="line"> <span class="keyword">my</span> $number = <span class="keyword">sprintf</span> <span class="string">&quot;%.2f&quot;</span>, <span class="keyword">shift</span> @_;</span><br><span class="line"> <span class="comment"># Add one comma each time through the do-nothing loop</span></span><br><span class="line"> <span class="number">1</span> <span class="keyword">while</span> $number =~ <span class="regexp">s/^(-?\d+)(\d\d\d)/$1,$2/</span>;</span><br><span class="line"> <span class="comment"># Put the dollar sign in the right place</span></span><br><span class="line"> $number =~ <span class="regexp">s/^(-?)/$1\$/</span>;</span><br><span class="line"> $number;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上述第四行的while循环是一个倒装，效果是每次从后向前匹配3个数字，在前方插入逗号，匹配成功后进入循环，但是循环主体是1，也就是什么也不做。接着进行下一次替换，直到替换失败返回false。</p>
<h3 id="高级排序"><a href="#高级排序" class="headerlink" title="高级排序"></a>高级排序</h3><p>perl运行按照自定义规则进行排序(有点像运算符的重载),只需要自定义一个排序子函数，然后将其放在sort和列表之间：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">by_number</span> </span>&#123;</span><br><span class="line"> <span class="comment"># a sort subroutine, expect $a and $b</span></span><br><span class="line"> <span class="keyword">if</span> ($a &lt; $b) &#123; -<span class="number">1</span> &#125; <span class="keyword">elsif</span> ($a &gt; $b) &#123; <span class="number">1</span> &#125; <span class="keyword">else</span> &#123; <span class="number">0</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">my</span> @result = <span class="keyword">sort</span> by_number @some_numbers;</span><br></pre></td></tr></table></figure>

<p>还有更简单的定义方式，称为飞船符号：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">by_number</span> </span>&#123; $a &lt;=&gt; $b &#125;</span><br></pre></td></tr></table></figure>

<p>可以利用字符串比较操作cmp来构建大小写不敏感的比较：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">by_code_point</span> </span>&#123; $a cmp $b &#125;</span><br><span class="line"><span class="keyword">my</span> @strings = <span class="keyword">sort</span> by_code_point @any_strings;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">case_insensitive</span> </span>&#123; <span class="string">&quot;\L$a&quot;</span> cmp <span class="string">&quot;\L$b&quot;</span> &#125;</span><br></pre></td></tr></table></figure>

<p>还可以进一步简化，直接在sort之后定义排序规则：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">my</span> @descending = <span class="keyword">sort</span> &#123; $b &lt;=&gt; $a &#125; @some_numbers;</span><br></pre></td></tr></table></figure>

<h3 id="按哈希值排序"><a href="#按哈希值排序" class="headerlink" title="按哈希值排序"></a>按哈希值排序</h3><p>例如，按照得分对球员进行排序：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> %score = (<span class="string">&quot;barney&quot;</span> =&gt; <span class="number">195</span>, <span class="string">&quot;fred&quot;</span> =&gt; <span class="number">205</span>, <span class="string">&quot;dino&quot;</span> =&gt; <span class="number">30</span>);</span><br><span class="line"><span class="keyword">my</span> @winners = <span class="keyword">sort</span> by_score <span class="keyword">keys</span> %score;</span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">by_score</span> </span>&#123; $score&#123;$b&#125; &lt;=&gt; $score&#123;$a&#125; &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (@winners)&#123;</span><br><span class="line">    <span class="keyword">say</span> <span class="string">&quot;$_ get $score&#123;$_&#125; scores&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意这里定义的子函数by_score,它通过比较2个键对应的值，对原本的键进行降序排序。</p>
<h3 id="按照多个键进行排序"><a href="#按照多个键进行排序" class="headerlink" title="按照多个键进行排序"></a>按照多个键进行排序</h3><p>如果有多个同分球员，则按照字符串规则进行排序：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">my</span> %score = (</span><br><span class="line">  <span class="string">&quot;barney&quot;</span> =&gt; <span class="number">195</span>, <span class="string">&quot;fred&quot;</span> =&gt; <span class="number">205</span>,</span><br><span class="line">  <span class="string">&quot;dino&quot;</span> =&gt; <span class="number">30</span>, <span class="string">&quot;bamm-bamm&quot;</span> =&gt; <span class="number">195</span>,</span><br><span class="line"> );</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> @winners = <span class="keyword">sort</span> by_score_and_name <span class="keyword">keys</span> %score;</span><br><span class="line"> <span class="function"><span class="keyword">sub</span> <span class="title">by_score_and_name</span> </span>&#123;</span><br><span class="line">  $score&#123;$b&#125; &lt;=&gt; $score&#123;$a&#125;  <span class="comment"># by descending numeric score</span></span><br><span class="line">    <span class="keyword">or</span></span><br><span class="line">  $a cmp $b          <span class="comment"># code point order by name</span></span><br><span class="line">  &#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (@winners)&#123;</span><br><span class="line">    <span class="keyword">say</span> <span class="string">&quot;$_ get $score&#123;$_&#125; scores&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/05/08/LearnPerl/image-146.png"></p>
<p>实际应用中，可以定义多重比较规则：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@patron_IDs = <span class="keyword">sort</span> &#123;</span><br><span class="line">  &amp;fines($b) &lt;=&gt; &amp;fines($a) <span class="keyword">or</span></span><br><span class="line">  $items&#123;$b&#125; &lt;=&gt; $items&#123;$a&#125; <span class="keyword">or</span></span><br><span class="line">  $family_name&#123;$a&#125; cmp $family_name&#123;$b&#125; <span class="keyword">or</span></span><br><span class="line">  $personal_name&#123;$a&#125; cmp $family_name&#123;$b&#125; <span class="keyword">or</span></span><br><span class="line">  $a &lt;=&gt; $b</span><br><span class="line"> &#125; @patron_IDs;</span><br></pre></td></tr></table></figure>

<h3 id="习题-8"><a href="#习题-8" class="headerlink" title="习题"></a>习题</h3><p><img src="/2024/05/08/LearnPerl/image-147.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> @sorted = <span class="keyword">sort</span> &#123;$b &lt;=&gt; $a&#125; @ARGV;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> $result;</span><br><span class="line"><span class="keyword">foreach</span> (@sorted)&#123;</span><br><span class="line">    $result = $result . <span class="keyword">sprintf</span><span class="string">&quot;%12s\n&quot;</span>,$_;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">print</span> $result;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-148.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">my</span> %last_name = <span class="string">qw&#123;</span></span><br><span class="line"><span class="string">  fred flintstone Wilma Flintstone Barney Rubble</span></span><br><span class="line"><span class="string">  betty rubble Bamm-Bamm Rubble PEBBLES FLINTSTONE</span></span><br><span class="line"><span class="string"> &#125;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> <span class="keyword">my</span> $key (<span class="keyword">keys</span> %last_name)&#123;</span><br><span class="line">    <span class="keyword">say</span> <span class="string">&quot;$key - $last_name&#123;$key&#125;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">sort_by_me</span> </span>&#123;</span><br><span class="line">    <span class="string">&quot;\L$last_name&#123;$a&#125;&quot;</span> cmp <span class="string">&quot;\L$last_name&#123;$b&#125;&quot;</span> <span class="keyword">or</span> </span><br><span class="line">    <span class="string">&quot;\L$a&quot;</span> cmp <span class="string">&quot;\L$b&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;-----after sort------&quot;</span>;</span><br><span class="line"><span class="keyword">my</span> @sorted = <span class="keyword">sort</span> sort_by_me <span class="keyword">keys</span> %last_name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (@sorted)&#123;</span><br><span class="line">    <span class="keyword">say</span> <span class="string">&quot;$_ - $last_name&#123;$_&#125;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-149.png"></p>
<p><img src="/2024/05/08/LearnPerl/image-150.png"></p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> $staff = @ARGV[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">my</span> $sub = @ARGV[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">@where=();</span><br><span class="line">$where = -<span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>)&#123;</span><br><span class="line">    $where = <span class="keyword">index</span>($staff,$sub,$where+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">last</span> <span class="keyword">if</span> $where== -<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">push</span> @where,$where;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">say</span> <span class="string">&quot;position is @where&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/LearnPerl/image-151.png"></p>
<h2 id="Ch15-进程管理"><a href="#Ch15-进程管理" class="headerlink" title="Ch15 进程管理"></a>Ch15 进程管理</h2><h3 id="system函数"><a href="#system函数" class="headerlink" title="system函数"></a>system函数</h3><p>在perl程序中可以直接使用<code>system</code>调用shell中函数：</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/perl</span></span><br><span class="line"><span class="keyword">use</span> v5.<span class="number">24</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">system</span> <span class="string">&#x27;date&#x27;</span>; </span><br><span class="line"><span class="keyword">system</span> <span class="string">&#x27;ls -l $HOME&#x27;</span>;</span><br><span class="line"><span class="keyword">system</span> <span class="string">&quot;ls -l \$HOME&quot;</span>;</span><br></pre></td></tr></table></figure>
<p>使用双引号时，需要对特殊字符进行转义。</p>
<p>system 实际上创建了一个子进程，从当前的perl程序切换到该子进程，执行结束后返回。</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Programming-Language/" rel="tag"># Programming Language</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2024/04/19/%E7%AC%A8%E5%8A%9E%E6%B3%95%E5%AD%A6C/" rel="prev" title="笨办法学C">
      <i class="fa fa-chevron-left"></i> 笨办法学C
    </a></div>
      <div class="post-nav-item">
    <a href="/2024/06/10/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%97%E9%9B%86%E6%88%90%E7%94%B5%E8%B7%AF%E8%AE%BE%E8%AE%A1/" rel="next" title="高等数字集成电路设计">
      高等数字集成电路设计 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Learn-Perl"><span class="nav-number">1.</span> <span class="nav-text">Learn Perl</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Ch2-%E6%A0%87%E9%87%8F%E6%95%B0%E6%8D%AE"><span class="nav-number">1.1.</span> <span class="nav-text">Ch2 标量数据</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E4%B8%AAHelloword-%E7%A8%8B%E5%BA%8F"><span class="nav-number">1.1.1.</span> <span class="nav-text">第一个Helloword 程序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%87%E9%87%8F%E6%95%B0%E6%8D%AE"><span class="nav-number">1.1.2.</span> <span class="nav-text">标量数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E7%89%B9%E6%80%A7"><span class="nav-number">1.1.3.</span> <span class="nav-text">其他特性</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ch3-%E5%88%97%E8%A1%A8%E5%92%8C%E6%95%B0%E7%BB%84"><span class="nav-number">1.2.</span> <span class="nav-text">Ch3 列表和数组</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E7%BB%84array"><span class="nav-number">1.2.1.</span> <span class="nav-text">数组array</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#array"><span class="nav-number">1.2.2.</span> <span class="nav-text">array</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#push-pop-shift-unshift"><span class="nav-number">1.2.2.1.</span> <span class="nav-text">push,pop,shift,unshift</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#splice"><span class="nav-number">1.2.2.2.</span> <span class="nav-text">splice</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%95%B0%E7%BB%84%E5%86%85%E6%8F%92"><span class="nav-number">1.2.2.3.</span> <span class="nav-text">字符串数组内插</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#foreach"><span class="nav-number">1.2.2.4.</span> <span class="nav-text">foreach</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%BB%98%E8%AE%A4%E5%8F%98%E9%87%8F"><span class="nav-number">1.2.2.5.</span> <span class="nav-text">默认变量 $_</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#reverse-sort-each"><span class="nav-number">1.2.2.6.</span> <span class="nav-text">reverse,sort,each</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%97%E8%A1%A8%E4%B8%8A%E4%B8%8B%E6%96%87%E4%B8%8E%E6%A0%87%E9%87%8F%E4%B8%8A%E4%B8%8B%E6%96%87"><span class="nav-number">1.2.2.7.</span> <span class="nav-text">列表上下文与标量上下文</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%97%E8%A1%A8%E4%B8%8A%E4%B8%8B%E6%96%87%E4%B8%AD%E4%BD%BF%E7%94%A8%E6%A0%87%E9%87%8F%E8%A1%A8%E8%BE%BE%E5%BC%8F-%E5%BC%BA%E5%88%B6%E6%A0%87%E9%87%8F%E4%B8%8A%E4%B8%8B%E6%96%87"><span class="nav-number">1.2.2.8.</span> <span class="nav-text">列表上下文中使用标量表达式&amp;强制标量上下文</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%97%E8%A1%A8%E4%B8%8A%E4%B8%8B%E6%96%87%E4%B8%AD%E7%9A%84"><span class="nav-number">1.2.2.9.</span> <span class="nav-text">列表上下文中的&lt;STDIN&gt;</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B9%A0%E9%A2%98"><span class="nav-number">1.2.3.</span> <span class="nav-text">习题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ch4-%E5%AD%90%E7%A8%8B%E5%BA%8F"><span class="nav-number">1.3.</span> <span class="nav-text">Ch4 子程序</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%98%E9%87%8F%E4%BC%A0%E9%80%92"><span class="nav-number">1.3.0.1.</span> <span class="nav-text">变量传递</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%90%E7%A8%8B%E5%BA%8F%E4%B8%AD%E7%9A%84%E7%A7%81%E6%9C%89%E5%8F%98%E9%87%8F"><span class="nav-number">1.3.0.2.</span> <span class="nav-text">子程序中的私有变量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#use-strict-%E7%BC%96%E8%AF%91%E6%8C%87%E4%BB%A4"><span class="nav-number">1.3.0.3.</span> <span class="nav-text">use strict 编译指令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E-return"><span class="nav-number">1.3.0.4.</span> <span class="nav-text">返回 return</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9C%81%E7%95%A5-%E7%AC%A6%E5%8F%B7"><span class="nav-number">1.3.0.5.</span> <span class="nav-text">省略&amp;符号</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9D%9E%E6%A0%87%E9%87%8F%E8%BE%93%E5%87%BA"><span class="nav-number">1.3.0.6.</span> <span class="nav-text">非标量输出</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8C%81%E7%BB%AD%E5%8F%98%E9%87%8F"><span class="nav-number">1.3.0.7.</span> <span class="nav-text">持续变量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%90%E5%87%BD%E6%95%B0%E7%AD%BE%E5%90%8Dsubroutine-signatures"><span class="nav-number">1.3.0.8.</span> <span class="nav-text">子函数签名subroutine signatures</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B9%A0%E9%A2%98-1"><span class="nav-number">1.3.1.</span> <span class="nav-text">习题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ch5-%E8%BE%93%E5%85%A5-%E8%BE%93%E5%87%BA"><span class="nav-number">1.4.</span> <span class="nav-text">Ch5 输入&#x2F;输出</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%87%E5%87%86%E8%BE%93%E5%85%A5%E6%B5%81"><span class="nav-number">1.4.1.</span> <span class="nav-text">标准输入流</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%92%BB%E7%9F%B3%E7%AC%A6%E5%8F%B7"><span class="nav-number">1.4.1.1.</span> <span class="nav-text">钻石符号&lt;&gt;</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%8C%E9%92%BB%E7%9F%B3%E7%AC%A6%E5%8F%B7"><span class="nav-number">1.4.1.2.</span> <span class="nav-text">双钻石符号 &lt;&lt;&gt;&gt;</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B0%83%E7%94%A8%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8"><span class="nav-number">1.4.1.3.</span> <span class="nav-text">调用参数列表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%87%E5%87%86%E8%BE%93%E5%87%BA"><span class="nav-number">1.4.1.4.</span> <span class="nav-text">标准输出</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8B%AC%E5%8F%B7"><span class="nav-number">1.4.1.5.</span> <span class="nav-text">括号</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%BC%E5%BC%8F%E5%8C%96%E8%BE%93%E5%87%BAprintf"><span class="nav-number">1.4.1.6.</span> <span class="nav-text">格式化输出printf</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%97%E8%A1%A8%E4%B8%8Eprintf"><span class="nav-number">1.4.1.7.</span> <span class="nav-text">列表与printf</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%8F%A5%E6%9F%84-filehandles"><span class="nav-number">1.4.2.</span> <span class="nav-text">文件句柄 filehandles</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%A0%BC%E5%BC%8Fbinmode"><span class="nav-number">1.4.3.</span> <span class="nav-text">二进制格式binmode</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%93%E6%9D%9F%E5%8F%A5%E6%9F%84"><span class="nav-number">1.4.3.1.</span> <span class="nav-text">结束句柄</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#die%E7%94%A8%E4%BA%8E%E5%A4%84%E7%90%86%E8%87%B4%E5%91%BD%E9%94%99%E8%AF%AF"><span class="nav-number">1.4.3.2.</span> <span class="nav-text">die用于处理致命错误</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%8F%A5%E6%9F%84%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">1.4.3.3.</span> <span class="nav-text">文件句柄的使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%87%8D%E6%96%B0%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6%E5%8F%A5%E6%9F%84"><span class="nav-number">1.4.3.4.</span> <span class="nav-text">重新打开文件句柄</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%87%E9%87%8F%E5%8F%98%E9%87%8F%E7%9A%84%E5%8F%A5%E6%9F%84"><span class="nav-number">1.4.3.5.</span> <span class="nav-text">标量变量的句柄</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B9%A0%E9%A2%98-2"><span class="nav-number">1.4.4.</span> <span class="nav-text">习题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ch6-%E5%93%88%E5%B8%8C"><span class="nav-number">1.5.</span> <span class="nav-text">Ch6 哈希</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A6%82%E5%BF%B5"><span class="nav-number">1.5.1.</span> <span class="nav-text">概念</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AE%AD%E5%A4%B4%E7%AC%A6%E5%8F%B7"><span class="nav-number">1.5.1.1.</span> <span class="nav-text">箭头符号 &#x3D;&gt;</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%93%88%E5%B8%8C%E5%87%BD%E6%95%B0"><span class="nav-number">1.5.2.</span> <span class="nav-text">哈希函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#keys-%E5%92%8C-values"><span class="nav-number">1.5.2.1.</span> <span class="nav-text">keys 和 values</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#each%E5%87%BD%E6%95%B0"><span class="nav-number">1.5.2.2.</span> <span class="nav-text">each函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exist-delete%E5%92%8C%E5%86%85%E6%8F%92"><span class="nav-number">1.5.2.3.</span> <span class="nav-text">exist, delete和内插</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="nav-number">1.5.2.4.</span> <span class="nav-text">环境变量</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B9%A0%E9%A2%98-3"><span class="nav-number">1.5.3.</span> <span class="nav-text">习题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ch7-%E6%BC%AB%E6%B8%B8%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-number">1.6.</span> <span class="nav-text">Ch7 漫游正则表达式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="nav-number">1.6.1.</span> <span class="nav-text">正则表达式的概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E9%85%8D"><span class="nav-number">1.6.2.</span> <span class="nav-text">通配</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%87%8F%E8%AF%8D-%EF%BC%8C-m-n"><span class="nav-number">1.6.3.</span> <span class="nav-text">量词 *,?, +，{m,n}</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E5%BC%8F%E5%88%86%E7%BB%84-%E4%B8%8E%E5%8F%8D%E5%90%91%E5%BC%95%E7%94%A8g"><span class="nav-number">1.6.4.</span> <span class="nav-text">模式分组 ()与反向引用g{}</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%89%E6%8B%A9%E7%AC%A6"><span class="nav-number">1.6.5.</span> <span class="nav-text">选择符 |</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E9%9B%86"><span class="nav-number">1.6.6.</span> <span class="nav-text">字符集[]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E9%9B%86%E7%9A%84%E7%AE%80%E5%86%99"><span class="nav-number">1.6.7.</span> <span class="nav-text">字符集的简写</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Unicode-%E7%89%B9%E6%80%A7"><span class="nav-number">1.6.8.</span> <span class="nav-text">Unicode 特性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%94%9A%E7%82%B9Anchor"><span class="nav-number">1.6.9.</span> <span class="nav-text">锚点Anchor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%8D%E9%94%9A-word-anchor"><span class="nav-number">1.6.10.</span> <span class="nav-text">词锚 word anchor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B9%A0%E9%A2%98-4"><span class="nav-number">1.6.11.</span> <span class="nav-text">习题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ch8-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%BF%9B%E8%A1%8C%E5%8C%B9%E9%85%8D"><span class="nav-number">1.7.</span> <span class="nav-text">Ch8 正则表达式进行匹配</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#i%E8%BF%9B%E8%A1%8C%E5%A4%A7%E5%B0%8F%E5%86%99%E6%97%A0%E5%85%B3%E7%9A%84%E5%8C%B9%E9%85%8D"><span class="nav-number">1.7.1.</span> <span class="nav-text">&#x2F;i进行大小写无关的匹配</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#s%E8%BF%9B%E8%A1%8C%E4%BB%BB%E6%84%8F%E5%AD%97%E7%AC%A6%E7%9A%84%E5%8C%B9%E9%85%8D"><span class="nav-number">1.7.2.</span> <span class="nav-text">&#x2F;s进行任意字符的匹配</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#x%E5%8A%A0%E5%85%A5%E7%A9%BA%E7%99%BD%E7%AC%A6"><span class="nav-number">1.7.3.</span> <span class="nav-text">&#x2F;x加入空白符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E9%A5%B0%E7%AC%A6%E5%8F%B7%E7%9A%84%E7%BB%84%E5%90%88"><span class="nav-number">1.7.4.</span> <span class="nav-text">修饰符号的组合</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%89%E6%8B%A9%E4%B8%80%E7%A7%8D%E5%AD%97%E7%AC%A6%E7%9A%84%E8%A7%A3%E9%87%8A%E6%96%B9%E5%BC%8F"><span class="nav-number">1.7.5.</span> <span class="nav-text">选择一种字符的解释方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#m%E8%BF%9B%E8%A1%8C%E8%A1%8C%E5%8C%B9%E9%85%8D"><span class="nav-number">1.7.6.</span> <span class="nav-text">\m进行行匹配</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E6%93%8D%E4%BD%9C"><span class="nav-number">1.7.7.</span> <span class="nav-text">其他操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%91%E5%AE%9A%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="nav-number">1.7.7.1.</span> <span class="nav-text">绑定操作符 &#x3D;~</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8D%95%E8%8E%B7%E5%8F%98%E9%87%8F"><span class="nav-number">1.7.7.2.</span> <span class="nav-text">捕获变量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8D%95%E8%8E%B7%E5%8F%98%E9%87%8F%E7%9A%84%E5%AD%98%E7%BB%AD%E6%9C%9F"><span class="nav-number">1.7.7.3.</span> <span class="nav-text">捕获变量的存续期</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8D%E6%8D%95%E8%8E%B7%E5%9C%86%E6%8B%AC%E5%8F%B7"><span class="nav-number">1.7.7.4.</span> <span class="nav-text">不捕获圆括号 (?:)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%91%BD%E5%90%8D%E6%8D%95%E8%8E%B7"><span class="nav-number">1.7.7.5.</span> <span class="nav-text">命名捕获</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%87%AA%E5%8A%A8%E6%8D%95%E8%8E%B7%E5%8F%98%E9%87%8F"><span class="nav-number">1.7.7.6.</span> <span class="nav-text">自动捕获变量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BC%98%E5%85%88%E7%BA%A7"><span class="nav-number">1.7.7.7.</span> <span class="nav-text">优先级</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95%E7%A8%8B%E5%BA%8F"><span class="nav-number">1.7.7.8.</span> <span class="nav-text">测试程序</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B9%A0%E9%A2%98-5"><span class="nav-number">1.7.8.</span> <span class="nav-text">习题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ch9-%E7%94%A8%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%A4%84%E7%90%86%E6%96%87%E4%BB%B6"><span class="nav-number">1.8.</span> <span class="nav-text">Ch9 用正则表达式处理文件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%A8s-%E8%BF%9B%E8%A1%8C%E6%9B%BF%E6%8D%A2"><span class="nav-number">1.8.1.</span> <span class="nav-text">用s&#x2F;&#x2F;&#x2F;进行替换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8g%E8%BF%9B%E8%A1%8C%E5%85%A8%E5%B1%80%E6%9B%BF%E6%8D%A2"><span class="nav-number">1.8.2.</span> <span class="nav-text">使用g进行全局替换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%90%8C%E7%9A%84%E7%95%8C%E5%AE%9A%E7%AC%A6"><span class="nav-number">1.8.3.</span> <span class="nav-text">使用不同的界定符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9B%BF%E6%8D%A2%E4%BF%AE%E9%A5%B0%E7%AC%A6"><span class="nav-number">1.8.4.</span> <span class="nav-text">替换修饰符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%91%E5%AE%9A%E6%93%8D%E4%BD%9C%E7%AC%A6-1"><span class="nav-number">1.8.5.</span> <span class="nav-text">绑定操作符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%A0%E6%8D%9F%E6%9B%BF%E6%8D%A2"><span class="nav-number">1.8.6.</span> <span class="nav-text">无损替换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%A7%E5%B0%8F%E5%86%99%E8%BD%AC%E6%8D%A2"><span class="nav-number">1.8.7.</span> <span class="nav-text">大小写转换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%83%E5%BC%95%E7%94%A8"><span class="nav-number">1.8.8.</span> <span class="nav-text">元引用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#split%E6%93%8D%E4%BD%9C"><span class="nav-number">1.8.9.</span> <span class="nav-text">split操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#join%E6%93%8D%E4%BD%9C"><span class="nav-number">1.8.10.</span> <span class="nav-text">join操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%97%E8%A1%A8%E4%B8%8A%E4%B8%8B%E6%96%87%E4%B8%AD%E7%9A%84%E5%8C%B9%E9%85%8D"><span class="nav-number">1.8.11.</span> <span class="nav-text">列表上下文中的匹配</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9B%B4%E5%BC%BA%E5%A4%A7%E7%9A%84%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-number">1.8.12.</span> <span class="nav-text">更强大的正则表达式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9D%9E%E8%B4%AA%E5%A9%AA%E9%87%8F%E8%AF%8D"><span class="nav-number">1.8.12.1.</span> <span class="nav-text">非贪婪量词</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9B%B4%E5%A5%BD%E7%9A%84%E5%8D%95%E8%AF%8D%E8%BE%B9%E7%95%8C"><span class="nav-number">1.8.12.2.</span> <span class="nav-text">更好的单词边界</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%84%E7%90%86%E5%A4%9A%E8%A1%8C%E6%96%87%E6%9C%AC"><span class="nav-number">1.8.12.3.</span> <span class="nav-text">处理多行文本</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E6%AC%A1%E6%9B%B4%E6%96%B0%E5%A4%9A%E4%B8%AA%E6%96%87%E4%BB%B6"><span class="nav-number">1.8.12.4.</span> <span class="nav-text">一次更新多个文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%9A%E8%BF%87%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%9B%B4%E6%8E%A5%E7%BC%96%E8%BE%91"><span class="nav-number">1.8.12.5.</span> <span class="nav-text">通过命令行直接编辑</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%BE%E5%90%8E%E4%B9%A0%E9%A2%98"><span class="nav-number">1.8.13.</span> <span class="nav-text">课后习题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ch10-%E5%85%B6%E4%BB%96%E6%8E%A7%E5%88%B6%E7%BB%93%E6%9E%84"><span class="nav-number">1.9.</span> <span class="nav-text">Ch10 其他控制结构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#unless"><span class="nav-number">1.9.1.</span> <span class="nav-text">unless</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#until%E7%BB%93%E6%9E%84"><span class="nav-number">1.9.2.</span> <span class="nav-text">until结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%BF%AE%E9%A5%B0%E7%AC%A6"><span class="nav-number">1.9.3.</span> <span class="nav-text">表达式修饰符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A3%B8%E5%9D%97%E6%8E%A7%E5%88%B6%E7%BB%93%E6%9E%84"><span class="nav-number">1.9.4.</span> <span class="nav-text">裸块控制结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#if-elsif%E7%BB%93%E6%9E%84"><span class="nav-number">1.9.5.</span> <span class="nav-text">if elsif结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%A2%9E%E4%B8%8E%E8%87%AA%E5%87%8F"><span class="nav-number">1.9.6.</span> <span class="nav-text">自增与自减</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#for-%E5%BE%AA%E7%8E%AF"><span class="nav-number">1.9.7.</span> <span class="nav-text">for 循环</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#for-%E4%B8%8Eforeach%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="nav-number">1.9.8.</span> <span class="nav-text">for 与foreach的关系</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BE%AA%E7%8E%AF%E6%8E%A7%E5%88%B6"><span class="nav-number">1.9.9.</span> <span class="nav-text">循环控制</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#last%E6%93%8D%E4%BD%9C"><span class="nav-number">1.9.9.1.</span> <span class="nav-text">last操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#next%E6%93%8D%E4%BD%9C"><span class="nav-number">1.9.9.2.</span> <span class="nav-text">next操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#redo%E6%93%8D%E4%BD%9C"><span class="nav-number">1.9.9.3.</span> <span class="nav-text">redo操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%A6%E6%A0%87%E7%AD%BE%E7%9A%84%E5%9D%97"><span class="nav-number">1.9.9.4.</span> <span class="nav-text">带标签的块</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="nav-number">1.9.10.</span> <span class="nav-text">条件操作符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%BB%E8%BE%91%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="nav-number">1.9.11.</span> <span class="nav-text">逻辑操作符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E6%88%96%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="nav-number">1.9.12.</span> <span class="nav-text">定义或操作符 \\</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E9%83%A8%E5%88%86%E6%B1%82%E5%80%BC%E6%93%8D%E4%BD%9C%E7%AC%A6%E8%BF%9B%E8%A1%8C%E6%8E%A7%E5%88%B6"><span class="nav-number">1.9.13.</span> <span class="nav-text">使用部分求值操作符进行控制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%BE%E5%90%8E%E4%B9%A0%E9%A2%98-1"><span class="nav-number">1.9.14.</span> <span class="nav-text">课后习题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ch11-Perl%E6%A8%A1%E5%9D%97"><span class="nav-number">1.10.</span> <span class="nav-text">Ch11 Perl模块</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8B%E8%BD%BD"><span class="nav-number">1.10.1.</span> <span class="nav-text">下载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E5%9D%97%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">1.10.2.</span> <span class="nav-text">模块的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#File-Basename-%E4%BD%BF%E7%94%A8"><span class="nav-number">1.10.2.1.</span> <span class="nav-text">File::Basename 使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E9%83%A8%E5%88%86%E5%87%BD%E6%95%B0"><span class="nav-number">1.10.2.2.</span> <span class="nav-text">使用部分函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#spec%E6%A8%A1%E5%9D%97"><span class="nav-number">1.10.2.3.</span> <span class="nav-text">spec模块</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DBI-%EF%BC%88Database-Interface%EF%BC%89%E6%A8%A1%E5%9D%97"><span class="nav-number">1.10.2.4.</span> <span class="nav-text">DBI （Database Interface）模块</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%B6%E9%97%B4%E5%92%8C%E6%97%A5%E6%9C%9F%E7%9A%84%E6%A8%A1%E5%9D%97"><span class="nav-number">1.10.2.5.</span> <span class="nav-text">时间和日期的模块</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B9%A0%E9%A2%98-6"><span class="nav-number">1.10.3.</span> <span class="nav-text">习题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ch12-%E6%96%87%E4%BB%B6%E6%B5%8B%E8%AF%95"><span class="nav-number">1.11.</span> <span class="nav-text">Ch12 文件测试</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E6%B5%8B%E8%AF%95%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="nav-number">1.11.1.</span> <span class="nav-text">文件测试操作符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95%E5%90%8C%E4%B8%80%E6%96%87%E4%BB%B6%E7%9A%84%E5%A4%9A%E4%B8%AA%E5%B1%9E%E6%80%A7"><span class="nav-number">1.11.2.</span> <span class="nav-text">测试同一文件的多个属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%88%E5%BC%8F%E6%96%87%E4%BB%B6%E6%B5%8B%E8%AF%95%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="nav-number">1.11.3.</span> <span class="nav-text">栈式文件测试操作符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#stat%E5%92%8Clstat%E5%87%BD%E6%95%B0"><span class="nav-number">1.11.4.</span> <span class="nav-text">stat和lstat函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E4%BA%9B%E9%87%8D%E8%A6%81%E7%9A%84%E6%96%87%E4%BB%B6%E4%BF%A1%E6%81%AF"><span class="nav-number">1.11.4.1.</span> <span class="nav-text">一些重要的文件信息</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#dev%E5%92%8C-ino"><span class="nav-number">1.11.4.1.1.</span> <span class="nav-text">$dev和$ino</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#mode"><span class="nav-number">1.11.4.1.2.</span> <span class="nav-text">$mode</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#nlink"><span class="nav-number">1.11.4.1.3.</span> <span class="nav-text">$nlink</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#uid%E5%92%8C-gid"><span class="nav-number">1.11.4.1.4.</span> <span class="nav-text">$uid和$gid</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#size"><span class="nav-number">1.11.4.1.5.</span> <span class="nav-text">$size</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#atime-mtime-time"><span class="nav-number">1.11.4.1.6.</span> <span class="nav-text">$atime,$mtime,$time</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#localtime%E5%87%BD%E6%95%B0"><span class="nav-number">1.11.5.</span> <span class="nav-text">localtime函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%89%E4%BD%8D%E8%BF%90%E7%AE%97%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="nav-number">1.11.6.</span> <span class="nav-text">按位运算操作符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%89%E4%BD%8D%E6%93%8D%E4%BD%9C%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">1.11.7.</span> <span class="nav-text">按位操作字符串</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%BE%E5%90%8E%E4%B9%A0%E9%A2%98-2"><span class="nav-number">1.11.8.</span> <span class="nav-text">课后习题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ch13-%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C"><span class="nav-number">1.12.</span> <span class="nav-text">Ch13 目录操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BD%93%E5%89%8D%E5%B7%A5%E4%BD%9C%E7%9B%AE%E5%BD%95-%E5%9C%A8%E7%9B%AE%E5%BD%95%E6%A0%91%E4%B8%AD%E7%A7%BB%E5%8A%A8"><span class="nav-number">1.12.1.</span> <span class="nav-text">当前工作目录&#x2F;在目录树中移动</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E9%85%8Dglobbing"><span class="nav-number">1.12.2.</span> <span class="nav-text">通配globbing</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E9%85%8D%E7%9A%84%E5%8F%A6%E4%B8%80%E7%A7%8D%E8%AF%AD%E6%B3%95"><span class="nav-number">1.12.3.</span> <span class="nav-text">通配的另一种语法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E5%8F%A5%E6%9F%84"><span class="nav-number">1.12.4.</span> <span class="nav-text">目录句柄</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6"><span class="nav-number">1.12.5.</span> <span class="nav-text">删除文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%87%8D%E5%91%BD%E5%90%8D%E6%96%87%E4%BB%B6"><span class="nav-number">1.12.6.</span> <span class="nav-text">重命名文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%93%BE%E6%8E%A5%E4%B8%8E%E6%96%87%E4%BB%B6"><span class="nav-number">1.12.7.</span> <span class="nav-text">链接与文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%92%8C%E5%88%A0%E9%99%A4%E7%9B%AE%E5%BD%95"><span class="nav-number">1.12.8.</span> <span class="nav-text">创建和删除目录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E6%9D%83%E9%99%90"><span class="nav-number">1.12.9.</span> <span class="nav-text">修改权限</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E9%9A%B6%E5%B1%9E%E5%85%B3%E7%B3%BB"><span class="nav-number">1.12.10.</span> <span class="nav-text">修改隶属关系</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E6%97%B6%E9%97%B4%E6%88%B3"><span class="nav-number">1.12.11.</span> <span class="nav-text">修改时间戳</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B9%A0%E9%A2%98-7"><span class="nav-number">1.12.12.</span> <span class="nav-text">习题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ch14-%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%8E%E6%8E%92%E5%BA%8F"><span class="nav-number">1.13.</span> <span class="nav-text">Ch14 字符串与排序</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%A8index%E6%9F%A5%E6%89%BE%E5%AD%90%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">1.13.1.</span> <span class="nav-text">用index查找子字符串</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%A8substr%E6%93%8D%E4%BD%9C%E5%AD%90%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">1.13.2.</span> <span class="nav-text">用substr操作子字符串</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%A8sprintf%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">1.13.3.</span> <span class="nav-text">用sprintf格式化字符串</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%94%A8sprintf%E6%A0%BC%E5%BC%8F%E5%8C%96%E9%87%91%E9%A2%9D%E6%95%B0%E5%AD%97"><span class="nav-number">1.13.3.1.</span> <span class="nav-text">用sprintf格式化金额数字</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%AB%98%E7%BA%A7%E6%8E%92%E5%BA%8F"><span class="nav-number">1.13.4.</span> <span class="nav-text">高级排序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%89%E5%93%88%E5%B8%8C%E5%80%BC%E6%8E%92%E5%BA%8F"><span class="nav-number">1.13.5.</span> <span class="nav-text">按哈希值排序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%89%E7%85%A7%E5%A4%9A%E4%B8%AA%E9%94%AE%E8%BF%9B%E8%A1%8C%E6%8E%92%E5%BA%8F"><span class="nav-number">1.13.6.</span> <span class="nav-text">按照多个键进行排序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B9%A0%E9%A2%98-8"><span class="nav-number">1.13.7.</span> <span class="nav-text">习题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ch15-%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86"><span class="nav-number">1.14.</span> <span class="nav-text">Ch15 进程管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#system%E5%87%BD%E6%95%B0"><span class="nav-number">1.14.1.</span> <span class="nav-text">system函数</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Wang xianke</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">10</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Wangxianke123" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Wangxianke123" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:yourname@gmail.com" title="E-Mail → mailto:yourname@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Wang xianke</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">183k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">5:33</span>
</div>

        








      </div>
      <script src="https://Wangxianke123.github.io/live2d/autoload.js"></script>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  

</body>

</html>
